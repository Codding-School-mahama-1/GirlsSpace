<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GBV Prevention & Response | GirlsSpace</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="https://www.youtube.com/iframe_api"></script>
  
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&family=Playfair+Display:ital,wght@0,600;0,800;1,600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    body { font-family: 'Poppins', sans-serif; background: #f9f7fd; }
    .font-serif { font-family: 'Playfair Display', serif; }

    .nav-link::after {
      content: '';
      position: absolute;
      width: 0;
      height: 2px;
      bottom: -4px;
      left: 50%;
      background: linear-gradient(135deg, #ec4899 0%, #be185d 100%);
      transition: all 0.3s ease;
      transform: translateX(-50%);
    }
    .nav-link:hover::after {
      width: 100%;
    }
    
    .gradient-btn { background: linear-gradient(90deg, #ff5f8d, #c23cb6); transition: all 0.3s ease; }
    .gradient-btn:hover { box-shadow: 0 12px 30px rgba(194, 59, 182, 0.4); transform: translateY(-3px); }
    .gradient-btn:disabled { background: #cbd5e1; cursor: not-allowed; transform: none; box-shadow: none; opacity: 0.7; }
    
    .progress-bar { height: 12px; background: #e2e8f0; border-radius: 999px; overflow: hidden; }
    .progress-fill { height: 100%; background: linear-gradient(90deg, #ff5f8d, #c23cb6); width: 0%; transition: width 0.9s ease; }
    
    .module-locked { opacity: 0.6; pointer-events: none; filter: grayscale(100%); }

    .quiz-card {
      background: white;
      border-radius: 24px;
      box-shadow: 0 12px 35px rgba(0,0,0,0.1);
      transition: all 0.4s ease;
      border: 3px solid transparent;
    }
    .quiz-card:hover { border-color: #ff5f8d; }
    .quiz-option {
      background: #fdfafb;
      border: 2px solid #f0e6f6;
      border-radius: 18px;
      padding: 18px 22px;
      margin: 12px 0;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .quiz-option:hover { background: #fdf2f8; border-color: #ff5f8d; }
    .correct { background: #d4edda !important; border-color: #28a745 !important; }
    .wrong { background: #f8d7da !important; border-color: #dc3545 !important; }

    /* Certificate Styles */
    .certificate-border {
      border: 10px solid transparent;
      border-image: linear-gradient(to right, #c23cb6, #ff5f8d) 1;
      background: white;
    }
    .certificate-bg-pattern {
      background-image: radial-gradient(#f3e8f5 2px, transparent 2px);
      background-size: 30px 30px;
    }

    /* Video Overlay */
    .video-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 1rem; background: black; }
    .video-container iframe, .video-container .overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
    .video-container .overlay {
        background: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.6)), url('https://img.freepik.com/free-vector/flat-design-purple-wavyle-background_23-2149105265.jpg');
        background-size: cover;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        z-index: 10;
    }
    .video-container .overlay:hover .play-icon { transform: scale(1.1); }

    .modal-enter { animation: fadeIn 0.4s ease-out forwards; }
    @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
    
    /* Custom Scrollbar for mobile menu */
    .no-scrollbar::-webkit-scrollbar {
      display: none;
    }

    /* Hamburger Animation */
    .hamburger.active span:nth-child(1) { transform: rotate(45deg) translate(6px, 6px); }
    .hamburger.active span:nth-child(2) { opacity: 0; }
    .hamburger.active span:nth-child(3) { transform: rotate(-45deg) translate(6px, -6px); }
  </style>
</head>
<body class="bg-purple-50 text-gray-800">

  <!-- Navigation Bar -->
  <nav class="flex items-center justify-between px-5 py-3 bg-white sticky top-0 z-50 shadow-md md:px-10">
    <div class="w-[60px] h-[50px]">
      <img src="./img/Girls Space (1) (1).png" onerror="this.src='https://via.placeholder.com/60'" alt="Logo" class="w-full h-full object-contain rounded-full">
    </div>

    <div class="hidden lg:flex items-center gap-6 text-sm font-medium text-gray-700">
      <a href="./index.html" class="nav-link hover:text-primary-pink relative transition-colors" data-i18n="home">Home</a>
      <a href="./AboutUs.html" class="nav-link hover:text-primary-pink relative transition-colors" data-i18n="about">About</a>
      <a href="./chat.html" class="nav-link hover:text-primary-pink relative transition-colors" data-i18n="chat">Chat</a>
      <a href="./stories.html" class="nav-link hover:text-primary-pink relative transition-colors" data-i18n="stories">Stories</a>
      <a href="./Learning_Programs.html" class="nav-link hover:text-primary-pink relative transition-colors" data-i18n="programs">Programs</a>
      <a href="./protection.html" class="nav-link hover:text-primary-pink relative transition-colors" data-i18n="protection">Protection</a>

      <div class="relative group">
        <button class="flex items-center hover:text-primary-pink transition-colors py-2" id="language-button">
          <span id="current-language">English</span> <i class="fas fa-chevron-down ml-1 text-xs"></i>
        </button>
        <ul class="absolute top-full left-0 bg-white shadow-xl rounded-lg w-32 hidden group-hover:block py-2 border border-gray-100">
          <li><button onclick="changeLanguage('en')" class="block w-full px-4 py-2 text-sm text-gray-700 hover:bg-purple-50 hover:text-custom-purple text-left">English</button></li>
          <li><button onclick="changeLanguage('ar')" class="block w-full px-4 py-2 text-sm text-gray-700 hover:bg-purple-50 hover:text-custom-purple text-left">Arabic</button></li>
          <li><button onclick="changeLanguage('sw')" class="block w-full px-4 py-2 text-sm text-gray-700 hover:bg-purple-50 hover:text-custom-purple text-left">Swahili</button></li>
          <li><button onclick="changeLanguage('fr')" class="block w-full px-4 py-2 text-sm text-gray-700 hover:bg-purple-50 hover:text-custom-purple text-left">French</button></li>
          <li><button onclick="changeLanguage('rw')" class="block w-full px-4 py-2 text-sm text-gray-700 hover:bg-purple-50 hover:text-custom-purple text-left">Kinyarwanda</button></li>
        </ul>
      </div>
      
      <a href="./login.html" class="px-4 py-1.5 border-[1.5px] border-custom-purple text-custom-purple rounded-full text-sm font-semibold hover:bg-purple-50 transition-colors" data-i18n="login">Log In</a>
      <a href="#" class="px-5 py-2 bg-gradient-to-r from-[#ff5f8d] to-[#c23cb6] text-white rounded-full text-sm font-semibold hover:shadow-lg hover:shadow-pink-200 transition-all border border-transparent hover:border-custom-purple" data-i18n="donate">Donate</a>
    </div>

    <div class="hidden lg:flex items-center gap-4">
      <div class="relative">
        <input type="text" placeholder="Search..." class="px-3 py-1.5 border border-gray-300 rounded-lg text-sm text-gray-700 outline-none focus:border-primary-pink w-[140px]" data-i18n-placeholder="search">
      </div>
    </div>

    <!-- Hamburger Button -->
    <button id="hamburger" class="lg:hidden flex flex-col gap-1.5 z-50 cursor-pointer group">
      <span class="w-7 h-[3px] bg-gray-700 rounded-full transition-all duration-300 group-[.active]:rotate-45 group-[.active]:translate-y-2"></span>
      <span class="w-7 h-[3px] bg-gray-700 rounded-full transition-all duration-300 group-[.active]:opacity-0"></span>
      <span class="w-7 h-[3px] bg-gray-700 rounded-full transition-all duration-300 group-[.active]:-rotate-45 group-[.active]:-translate-y-2.5"></span>
    </button>
  </nav>

  <!-- Mobile Menu Overlay -->
  <div id="mobile-menu-overlay" class="fixed inset-0 bg-black/50 z-40 hidden lg:hidden backdrop-blur-sm transition-opacity"></div>
  
  <!-- Mobile Menu -->
  <div id="mobile-menu" class="fixed top-0 left-[-100%] w-full h-full bg-white z-40 transition-all duration-300 lg:hidden overflow-y-auto no-scrollbar">
    <div class="pt-20 px-6 pb-10">
      <div class="flex flex-col gap-6 text-gray-700 font-medium">
        <a href="./index.html" class="py-2 border-b border-gray-100 hover:text-primary-pink transition-colors" data-i18n="home">Home</a>
        <a href="./AboutUs.html" class="py-2 border-b border-gray-100 hover:text-primary-pink transition-colors" data-i18n="about">About</a>
        <a href="./chat.html" class="py-2 border-b border-gray-100 hover:text-primary-pink transition-colors" data-i18n="chat">Chat</a>
        <a href="./stories.html" class="py-2 border-b border-gray-100 hover:text-primary-pink transition-colors" data-i18n="stories">Stories</a>
        <a href="./Learning_Programs.html" class="py-2 border-b border-gray-100 hover:text-primary-pink transition-colors" data-i18n="programs">Programs</a>
        <a href="./protection.html" class="py-2 border-b border-gray-100 hover:text-primary-pink transition-colors" data-i18n="protection">Protection</a>
        
        <div class="py-2 border-b border-gray-100">
          <div class="flex justify-between items-center">
            <span data-i18n="languages">Language</span>
            <select id="mobile-language-selector" class="bg-white border border-gray-300 rounded px-2 py-1 text-sm">
              <option value="en" selected>English</option>
              <option value="ar">Arabic</option>
              <option value="sw">Swahili</option>
              <option value="fr">French</option>
              <option value="rw">Kinyarwanda</option>
            </select>
          </div>
        </div>
        
        <a href="./login.html" class="px-4 py-2 border-[1.5px] border-custom-purple text-custom-purple rounded-full text-sm font-semibold hover:bg-purple-50 transition-colors text-center" data-i18n="login">Log In</a>
        <a href="#" class="px-4 py-2 bg-gradient-to-r from-[#ff5f8d] to-[#c23cb6] text-white rounded-full text-sm font-semibold hover:shadow-lg hover:shadow-pink-200 transition-all border border-transparent hover:border-custom-purple text-center" data-i18n="donate">Donate</a>
      </div>
    </div>
  </div>

  <!-- Second Navigation Bar (User Auth) -->
  <nav class="sticky top-14 z-40 bg-white shadow-sm border-b border-gray-200">
    <div class="container max-w-7xl mx-auto px-6 py-3">
      <div class="flex justify-between items-center">
        <div class="flex items-center gap-4">
          <span class="text-sm text-gray-600" data-i18n="gbv_course">GBV Prevention & Response Course</span>
        </div>
        <div id="auth-section" class="flex items-center gap-4">
          <button onclick="openLoginModal()" class="text-purple-700 font-semibold hover:text-pink-600 flex items-center gap-2 text-sm">
            <i class="fas fa-user-circle text-lg"></i> <span data-i18n="login">Log In</span>
          </button>
        </div>
      </div>
    </div>
  </nav>

  <header class="bg-gradient-to-br from-pink-600 via-purple-600 to-indigo-700 text-white py-20 text-center">
    <div class="max-w-6xl mx-auto px-6">
      <h1 class="text-4xl md:text-6xl font-extrabold mb-6 leading-tight" data-i18n="gbv_title">Prevention & Response to <br/> Gender-Based Violence</h1>
      <p class="text-xl md:text-2xl opacity-95 max-w-3xl mx-auto" data-i18n="gbv_subtitle">Learn how to protect yourself and others.</p>
    </div>
  </header>

  <div class="container max-w-7xl mx-auto px-6 py-12">
    <div class="mb-12 bg-white rounded-3xl shadow-2xl p-8 border border-purple-100">
      <div class="flex flex-col md:flex-row justify-between items-center gap-6">
        <div class="text-center md:text-left">
          <h2 class="text-3xl font-bold text-purple-700" data-i18n="your_progress">Your Progress</h2>
          <p class="text-gray-500 mt-2" id="user-greeting" data-i18n="guest_user">Guest User</p>
        </div>
        <span id="progress-text" class="text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-pink-500 to-purple-600">0%</span>
      </div>
      <div class="progress-bar mt-6"><div id="progress-fill" class="progress-fill"></div></div>
    </div>

    <div id="modules-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-10"></div>

    <div id="completion-section" class="hidden mt-20 text-center space-y-8 animate-bounce-in">
        <div class="p-10 bg-gradient-to-r from-pink-100 to-purple-100 rounded-3xl border-4 border-white shadow-2xl">
            <h2 class="text-4xl font-extrabold text-purple-800 mb-4" data-i18n="course_completed">Course Completed! ðŸŒŸ</h2>
            <p class="text-xl text-gray-600 mb-8" data-i18n="all_modules_passed">You have passed all modules.</p>
            <button onclick="showCertificate()" class="gradient-btn text-white px-12 py-6 rounded-full text-2xl font-bold shadow-2xl hover:scale-105 transition-transform">
                <i class="fas fa-certificate mr-3"></i> <span data-i18n="get_certificate">Get Certificate</span>
            </button>
        </div>
    </div>
  </div>

  <div id="login-modal" class="fixed inset-0 bg-black/80 z-[100] hidden flex items-center justify-center p-4 backdrop-blur-sm">
    <div class="bg-white rounded-3xl w-full max-w-md overflow-hidden modal-enter relative">
      <button onclick="closeLoginModal()" class="absolute top-4 right-4 text-gray-400 hover:text-red-500 text-2xl"><i class="fas fa-times"></i></button>
      <div class="p-8 text-center">
        <h3 class="text-2xl font-bold text-gray-800 mb-2" data-i18n="welcome">Welcome!</h3>
        <form id="login-form" class="space-y-4 text-left mt-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="your_name">Your Name</label>
            <input type="text" id="username-input" required class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-purple-500 outline-none" placeholder="Jane Doe">
          </div>
          <button type="submit" class="w-full gradient-btn text-white py-3 rounded-xl font-bold text-lg shadow-md" data-i18n="login_signup">Login / Sign Up</button>
        </form>
      </div>
    </div>
  </div>

  <div id="certificate-modal" class="fixed inset-0 bg-black/90 z-[200] hidden flex items-center justify-center p-4 overflow-y-auto">
    <div class="bg-white w-full max-w-4xl shadow-2xl relative modal-enter flex flex-col">
      <button onclick="document.getElementById('certificate-modal').classList.add('hidden')" class="absolute top-4 right-4 bg-gray-200 rounded-full w-10 h-10 z-10 hover:bg-red-100 hover:text-red-500"><i class="fas fa-times"></i></button>
      <div id="certificate-content" class="p-8 md:p-16 text-center certificate-border certificate-bg-pattern relative" style="width: 100%;">
        <i class="fas fa-award text-pink-500 text-4xl absolute top-6 left-6 opacity-50"></i>
        <i class="fas fa-award text-purple-500 text-4xl absolute top-6 right-6 opacity-50"></i>
        <h2 class="text-xl uppercase tracking-[0.3em] text-gray-500 font-semibold mb-4" data-i18n="certificate_of_completion">Certificate of Completion</h2>
        <h1 class="font-serif text-4xl md:text-5xl text-purple-800 font-bold italic mb-4">GirlsSpace Academy</h1>
        <p class="text-lg text-gray-600 my-4" data-i18n="this_certifies">This is to certify that</p>
        <div class="font-serif text-3xl md:text-4xl text-pink-600 border-b-2 border-gray-300 pb-2 px-10 mb-6 inline-block" id="cert-name">Name</div>
        <p class="text-lg text-gray-600 max-w-2xl mx-auto leading-relaxed mb-10" data-i18n="has_completed">Has successfully completed the program on <br><strong class="text-purple-700">"Prevention and Response to Gender-Based Violence"</strong></p>
        <div class="flex flex-row justify-between w-full px-8 mt-12">
          <div class="text-center"><p class="font-serif text-lg text-gray-800 border-t border-gray-400 pt-2 px-6" id="cert-date">Date</p><span class="text-xs text-gray-500 uppercase tracking-widest" data-i18n="date">Date</span></div>
          <div class="text-center"><div class="font-serif text-xl text-gray-800 mb-[-5px]" style="font-family: cursive;">GirlsSpace Team</div><p class="text-lg border-t border-gray-400 pt-2 px-6 mt-2"></p><span class="text-xs text-gray-500 uppercase tracking-widest" data-i18n="signature">Signature</span></div>
        </div>
      </div>
      <div class="text-center p-6 bg-gray-50 border-t border-gray-200">
         <button onclick="downloadPDF()" class="gradient-btn text-white px-10 py-3 rounded-full text-lg font-bold shadow-lg"><i class="fas fa-file-pdf mr-2"></i> <span data-i18n="download_pdf">Download PDF</span></button>
      </div>
    </div>
  </div>

  <footer class="bg-black text-slate-200 py-12 px-6 font-inter border-t border-slate-800">
    <div class="max-w-7xl mx-auto">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-8">
        
        <div class="col-span-1 md:col-span-2">
          <div class="flex items-center gap-3 mb-4">
            <img src="./img/Girls Space (1) (1).png" onerror="this.src='https://via.placeholder.com/50'" alt="Logo" class="w-[50px] h-[50px] object-contain rounded-full border-2 border-[rgb(255,135,219)]">
            <p class="font-semibold text-[rgb(255,135,219)] text-base" data-i18n="footer_subtitle">Empowering Girls, Building Futures</p>
          </div>
          <p class="text-sm leading-relaxed text-slate-400 max-w-sm mb-6" data-i18n="footer_desc">
            A safe digital haven where girls in Mahama refugee camp can connect, learn, grow, and thrive.
          </p>
          <div class="flex gap-3">
            <a href="#" class="w-10 h-10 bg-slate-800 border border-slate-700 rounded-lg flex items-center justify-center text-slate-300 hover:bg-slate-700 hover:text-white hover:-translate-y-1 transition-all"><i class="fab fa-facebook-f"></i></a>
            <a href="#" class="w-10 h-10 bg-slate-800 border border-slate-700 rounded-lg flex items-center justify-center text-slate-300 hover:bg-slate-700 hover:text-white hover:-translate-y-1 transition-all"><i class="fab fa-twitter"></i></a>
            <a href="#" class="w-10 h-10 bg-slate-800 border border-slate-700 rounded-lg flex items-center justify-center text-slate-300 hover:bg-slate-700 hover:text-white hover:-translate-y-1 transition-all"><i class="fab fa-instagram"></i></a>
            <a href="#" class="w-10 h-10 bg-slate-800 border border-slate-700 rounded-lg flex items-center justify-center text-slate-300 hover:bg-slate-700 hover:text-white hover:-translate-y-1 transition-all"><i class="fab fa-youtube"></i></a>
          </div>
        </div>

        <div>
          <h4 class="text-white font-semibold text-lg mb-4" data-i18n="quick_links">Quick Links</h4>
          <ul class="space-y-3 text-sm text-slate-400">
            <li><a href="#" class="hover:text-[rgb(219,120,228)] transition-colors" data-i18n="join_chat">Join Chat</a></li>
            <li><a href="#" class="hover:text-[rgb(219,120,228)] transition-colors" data-i18n="share_story">Share Story</a></li>
            <li><a href="#" class="hover:text-[rgb(219,120,228)] transition-colors" data-i18n="programs">Programs</a></li>
          </ul>
        </div>

        <div>
          <h4 class="text-white font-semibold text-lg mb-4" data-i18n="get_help">Get Help</h4>
          <ul class="space-y-3 text-sm text-slate-400">
            <li><a href="#" class="hover:text-[rgb(219,120,228)] transition-colors" data-i18n="emergency">Emergency</a></li>
            <li><a href="#" class="hover:text-[rgb(219,120,228)] transition-colors" data-i18n="support">Support</a></li>
            <li><a href="#" class="hover:text-[rgb(219,120,228)] transition-colors" data-i18n="report">Report</a></li>
          </ul>
        </div>
      </div>

      <div class="flex flex-col md:flex-row justify-between items-start md:items-end gap-4 pt-6 border-t border-slate-800 text-sm text-slate-500">
        <div>
          <p data-i18n="copyright">Â© 2025 GirlsSpace Mahama. <span class="text-[rgb(183,64,219)] font-medium" data-i18n="empowering_girls">Empowering girls, always.</span></p>
        </div>
        <div class="text-left md:text-right">
          <p class="mb-1" data-i18n="available_languages">Available in: English, FranÃ§ais, Kiswahili, Kinyarwanda, Arabic</p>
          <p data-i18n="supported_by">Supported by UNHCR, Save The Children, Alight</p>
        </div>
      </div>
    </div>
  </footer>

  <script>
    // --- Translations ---
    const translations = {
      en: {
        // Navigation
        home: "Home", about: "About", chat: "Chat", stories: "Stories", programs: "Programs", 
        protection: "Protection", languages: "Languages", login: "Log In", donate: "Donate",
        search: "Search...",
        gbv_course: "GBV Prevention & Response Course",
        
        // Page Content
        gbv_title: "Prevention & Response to Gender-Based Violence",
        gbv_subtitle: "Learn how to protect yourself and others.",
        your_progress: "Your Progress",
        guest_user: "Guest User",
        course_completed: "Course Completed! ðŸŒŸ",
        all_modules_passed: "You have passed all modules.",
        get_certificate: "Get Certificate",
        welcome: "Welcome!",
        your_name: "Your Name",
        login_signup: "Login / Sign Up",
        certificate_of_completion: "Certificate of Completion",
        this_certifies: "This is to certify that",
        has_completed: "Has successfully completed the program on",
        date: "Date",
        signature: "Signature",
        download_pdf: "Download PDF",
        
        // Footer
        footer_subtitle: "Empowering Girls, Building Futures",
        footer_desc: "A safe digital haven where girls in Mahama refugee camp can connect, learn, grow, and thrive.",
        quick_links: "Quick Links",
        join_chat: "Join Chat",
        share_story: "Share Story",
        get_help: "Get Help",
        emergency: "Emergency",
        support: "Support",
        report: "Report",
        copyright: "Â© 2025 GirlsSpace Mahama.",
        empowering_girls: "Empowering girls, always.",
        available_languages: "Available in: English, FranÃ§ais, Kiswahili, Kinyarwanda, Arabic",
        supported_by: "Supported by UNHCR, Save The Children, Alight"
      },
      ar: {
        // Navigation
        home: "Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©", about: "Ø¹Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹", chat: "Ø¯Ø±Ø¯Ø´Ø©", stories: "Ù‚ØµØµ", programs: "Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬", 
        protection: "Ø­Ù…Ø§ÙŠØ©", languages: "Ø§Ù„Ù„ØºØ§Øª", login: "Ø¯Ø®ÙˆÙ„", donate: "ØªØ¨Ø±Ø¹",
        search: "Ø¨Ø­Ø«...",
        gbv_course: "Ø¯ÙˆØ±Ø© Ø§Ù„ÙˆÙ‚Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ø¹Ù†Ù Ø§Ù„Ù‚Ø§Ø¦Ù… Ø¹Ù„Ù‰ Ø§Ù„Ù†ÙˆØ¹ ÙˆØ§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù‡",
        
        // Page Content
        gbv_title: "Ø§Ù„ÙˆÙ‚Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ø¹Ù†Ù Ø§Ù„Ù‚Ø§Ø¦Ù… Ø¹Ù„Ù‰ Ø§Ù„Ù†ÙˆØ¹ ÙˆØ§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù„Ù‡",
        gbv_subtitle: "ØªØ¹Ù„Ù… ÙƒÙŠÙÙŠØ© Ø­Ù…Ø§ÙŠØ© Ù†ÙØ³Ùƒ ÙˆØ§Ù„Ø¢Ø®Ø±ÙŠÙ†.",
        your_progress: "ØªÙ‚Ø¯Ù…Ùƒ",
        guest_user: "Ù…Ø³ØªØ®Ø¯Ù… Ø²Ø§Ø¦Ø±",
        course_completed: "ØªÙ… Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¯ÙˆØ±Ø©! ðŸŒŸ",
        all_modules_passed: "Ù„Ù‚Ø¯ Ø§Ø¬ØªØ²Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ­Ø¯Ø§Øª.",
        get_certificate: "Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©",
        welcome: "Ù…Ø±Ø­Ø¨Ø§Ù‹!",
        your_name: "Ø§Ø³Ù…Ùƒ",
        login_signup: "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ / Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨",
        certificate_of_completion: "Ø´Ù‡Ø§Ø¯Ø© Ø¥ØªÙ…Ø§Ù…",
        this_certifies: "Ù‡Ø°Ø§ ÙŠØ´Ù‡Ø¯ Ø¨Ø£Ù†",
        has_completed: "Ù‚Ø¯ Ø£ØªÙ… Ø¨Ù†Ø¬Ø§Ø­ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø­ÙˆÙ„",
        date: "Ø§Ù„ØªØ§Ø±ÙŠØ®",
        signature: "Ø§Ù„ØªÙˆÙ‚ÙŠØ¹",
        download_pdf: "ØªØ­Ù…ÙŠÙ„ PDF",
        
        // Footer
        footer_subtitle: "ØªÙ…ÙƒÙŠÙ† Ø§Ù„ÙØªÙŠØ§ØªØŒ Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„",
        footer_desc: "Ù…Ù„Ø§Ø° Ø±Ù‚Ù…ÙŠ Ø¢Ù…Ù† Ø­ÙŠØ« ÙŠÙ…ÙƒÙ† Ù„Ù„ÙØªÙŠØ§Øª ÙÙŠ Ù…Ø®ÙŠÙ… Ù…Ø§Ù‡Ø§Ù…Ø§ Ù„Ù„Ø§Ø¬Ø¦ÙŠÙ† Ø§Ù„ØªÙˆØ§ØµÙ„ ÙˆØ§Ù„ØªØ¹Ù„Ù… ÙˆØ§Ù„Ù†Ù…Ùˆ.",
        quick_links: "Ø±ÙˆØ§Ø¨Ø· Ø³Ø±ÙŠØ¹Ø©",
        join_chat: "Ø§Ù†Ø¶Ù… Ù„Ù„Ø¯Ø±Ø¯Ø´Ø©",
        share_story: "Ø´Ø§Ø±Ùƒ Ù‚ØµØ©",
        get_help: "Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©",
        emergency: "Ø·ÙˆØ§Ø±Ø¦",
        support: "Ø¯Ø¹Ù…",
        report: "Ø§Ù„Ø¥Ø¨Ù„Ø§Øº",
        copyright: "Â© 2025 GirlsSpace Mahama.",
        empowering_girls: "ØªÙ…ÙƒÙŠÙ† Ø§Ù„ÙØªÙŠØ§ØªØŒ Ø¯Ø§Ø¦Ù…Ø§Ù‹.",
        available_languages: "Ù…ØªÙˆÙØ± Ø¨Ù€: Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©ØŒ Ø§Ù„ÙØ±Ù†Ø³ÙŠØ©ØŒ Ø§Ù„Ø³ÙˆØ§Ø­ÙŠÙ„ÙŠØ©ØŒ Ø§Ù„ÙƒÙŠÙ†ÙŠØ§Ø±ÙˆØ§Ù†Ø¯Ø§ØŒ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",
        supported_by: "Ø¨Ø¯Ø¹Ù… Ù…Ù† UNHCRØŒ Save The ChildrenØŒ Alight"
      },
      fr: {
        // Navigation
        home: "Accueil", about: "Ã€ propos", chat: "Discuter", stories: "Histoires", programs: "Programmes", 
        protection: "Protection", languages: "Langues", login: "Connexion", donate: "Donner",
        search: "Rechercher...",
        gbv_course: "Cours de PrÃ©vention et RÃ©ponse Ã  la VBG",
        
        // Page Content
        gbv_title: "PrÃ©vention et rÃ©ponse Ã  la violence basÃ©e sur le genre",
        gbv_subtitle: "Apprenez Ã  vous protÃ©ger et Ã  protÃ©ger les autres.",
        your_progress: "Votre progression",
        guest_user: "Utilisateur invitÃ©",
        course_completed: "Cours terminÃ© ! ðŸŒŸ",
        all_modules_passed: "Vous avez rÃ©ussi tous les modules.",
        get_certificate: "Obtenir le certificat",
        welcome: "Bienvenue !",
        your_name: "Votre nom",
        login_signup: "Connexion / Inscription",
        certificate_of_completion: "Certificat d'achÃ¨vement",
        this_certifies: "Ceci certifie que",
        has_completed: "A terminÃ© avec succÃ¨s le programme sur",
        date: "Date",
        signature: "Signature",
        download_pdf: "TÃ©lÃ©charger PDF",
        
        // Footer
        footer_subtitle: "Autonomiser les filles, construire l'avenir",
        footer_desc: "Un havre numÃ©rique sÃ»r oÃ¹ les filles du camp de rÃ©fugiÃ©s de Mahama peuvent se connecter.",
        quick_links: "Liens rapides",
        join_chat: "Rejoindre le chat",
        share_story: "Partager une histoire",
        get_help: "Obtenir de l'aide",
        emergency: "Urgence",
        support: "Soutien",
        report: "Signaler",
        copyright: "Â© 2025 GirlsSpace Mahama.",
        empowering_girls: "Autonomiser les filles, toujours.",
        available_languages: "Disponible en: Anglais, FranÃ§ais, Kiswahili, Kinyarwanda, Arabe",
        supported_by: "Soutenu par UNHCR, Save The Children, Alight"
      },
      sw: {
        // Navigation
        home: "Nyumbani", about: "Kuhusu", chat: "Ongea", stories: "Hadithi", programs: "Mipango", 
        protection: "Ulinzi", languages: "Lugha", login: "Ingia", donate: "Changia",
        search: "Tafuta...",
        gbv_course: "Kozi ya Kuzuia na Kukabiliana na GBV",
        
        // Page Content
        gbv_title: "Kuzuia na Kukabiliana na Unyanyasaji wa Kijinsia",
        gbv_subtitle: "Jifunze jinsi ya kujilinda na kuwalinda wengine.",
        your_progress: "Maendeleo Yako",
        guest_user: "Mtumiaji Mgeni",
        course_completed: "Kozi Imekamilika! ðŸŒŸ",
        all_modules_passed: "Umefanikiwa kupita moduli zote.",
        get_certificate: "Pata Cheti",
        welcome: "Karibu!",
        your_name: "Jina Lako",
        login_signup: "Ingia / Jisajili",
        certificate_of_completion: "Cheti ya Kukamilisha",
        this_certifies: "Hii inathibitisha kuwa",
        has_completed: "Amehitimu mafanikio programu kuhusu",
        date: "Tarehe",
        signature: "Sahihi",
        download_pdf: "Pakua PDF",
        
        // Footer
        footer_subtitle: "Kuwawezesha Wasichana, Kujenga Mustakabali",
        footer_desc: "Mahali salama pa kidijitali ambapo wasichana katika kambi ya wakimbizi ya Mahama wanaweza kuungana.",
        quick_links: "Viungo vya Haraka",
        join_chat: "Jiunge na Mazungumzo",
        share_story: "Shiriki Hadithi",
        get_help: "Pata Msaada",
        emergency: "Dharura",
        support: "Msaada",
        report: "Ripoti",
        copyright: "Â© 2025 GirlsSpace Mahama.",
        empowering_girls: "Kuwawezesha wasichana, daima.",
        available_languages: "Inapatikana kwa: Kiingereza, Kifaransa, Kiswahili, Kinyarwanda, Kiarabu",
        supported_by: "Inasaidiwa na UNHCR, Save The Children, Alight"
      },
      rw: {
        // Navigation
        home: "Ahabanza", about: "Abo turi", chat: "Kuganira", stories: "Inkuru", programs: "Porogaramu", 
        protection: "Umutekano", languages: "Indimi", login: "Injira", donate: "Tanga",
        search: "Shakisha...",
        gbv_course: "Isomo ryo Kwirinda no Gukemura GBV",
        
        // Page Content
        gbv_title: "Kwirinda no Gukemura Ibikorwa by'Ubugome Bushingiye ku Gitsina",
        gbv_subtitle: "Jya ubona uburyo bwo kwirinda no kurinda abandi.",
        your_progress: "Iterambere Ryawe",
        guest_user: "Ukoresha utazwe",
        course_completed: "Isomo Ryarakozwe! ðŸŒŸ",
        all_modules_passed: "Waratsinze modulo zose.",
        get_certificate: "Kwakira Icyangombwa",
        welcome: "Murakaza neza!",
        your_name: "Izina ryawe",
        login_signup: "Injira / Iyandike",
        certificate_of_completion: "Icyangombwa cyo Kurangiza",
        this_certifies: "Ibi bihamya ko",
        has_completed: "Yarangiye neza porogaramu ku",
        date: "Itariki",
        signature: "Umukono",
        download_pdf: "Kuramo PDF",
        
        // Footer
        footer_subtitle: "Guharanira Abahungu, Kubaka Ejo Hazaza",
        footer_desc: "Ahantu hatekanye h'ikijyambere aho abahungu bo mu rugo rw'abimukanyi rwa Mahama bashobora kwihuza.",
        quick_links: "Amahuza Yihuse",
        join_chat: "Injira mu Kuganira",
        share_story: "Sangiza Inkuru",
        get_help: "Kwakira Ubufasha",
        emergency: "Ubutabazi",
        support: "Gushigikira",
        report: "Gutanga Raporo",
        copyright: "Â© 2025 GirlsSpace Mahama.",
        empowering_girls: "Guharanira abahungu, buri gihe.",
        available_languages: "Biboneka mu: Icyongereza, Igifaransa, Igiswahili, Ikinyarwanda, Icyarabu",
        supported_by: "Bishigikijwe na: UNHCR, Save The Children, Alight"
      }
    };

    // --- Language Management ---
    function getCurrentLanguage() {
      return localStorage.getItem('selectedLanguage') || 'en';
    }

    function setCurrentLanguage(lang) {
      localStorage.setItem('selectedLanguage', lang);
      applyTranslations(lang);
      updateLanguageSelector(lang);
      updatePageDirection(lang);
    }

    function applyTranslations(lang) {
      console.log('Applying translations for:', lang);
      
      // Update all elements with data-i18n
      document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (translations[lang] && translations[lang][key]) {
          element.textContent = translations[lang][key];
        }
      });
      
      // Update placeholder texts
      document.querySelectorAll('[data-i18n-placeholder]').forEach(element => {
        const key = element.getAttribute('data-i18n-placeholder');
        if (translations[lang] && translations[lang][key]) {
          element.placeholder = translations[lang][key];
        }
      });
    }

    function updateLanguageSelector(lang) {
      const languageNames = {
        'en': 'English',
        'ar': 'Arabic',
        'sw': 'Swahili',
        'fr': 'French',
        'rw': 'Kinyarwanda'
      };
      
      // Update desktop language button
      const currentLanguageElement = document.getElementById('current-language');
      if (currentLanguageElement) {
        currentLanguageElement.textContent = languageNames[lang];
      }
      
      // Update mobile language selector
      const mobileLanguageSelector = document.getElementById('mobile-language-selector');
      if (mobileLanguageSelector) {
        mobileLanguageSelector.value = lang;
      }
    }

    function updatePageDirection(lang) {
      document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
      document.documentElement.lang = lang;
    }

    function changeLanguage(lang) {
      console.log('Changing language to:', lang);
      setCurrentLanguage(lang);
      // Close mobile menu after language change
      if (document.getElementById('mobile-menu').style.left === '0px') {
        toggleMenu();
      }
    }

    // --- Mobile Menu Functionality ---
    function toggleMenu() {
      const hamburger = document.getElementById('hamburger');
      const mobileMenu = document.getElementById('mobile-menu');
      const overlay = document.getElementById('mobile-menu-overlay');
      
      hamburger.classList.toggle('active');
      const isOpen = hamburger.classList.contains('active');
      if (isOpen) {
        mobileMenu.style.left = '0';
        overlay.classList.remove('hidden');
      } else {
        mobileMenu.style.left = '-100%';
        overlay.classList.add('hidden');
      }
    }

    // --- Module Data (Using Video IDs instead of full URLs for API) ---
    const modules = [
      {title: "Introduction to GBV", videoId: "-eVdXMmYC_E"},
      {title: "Types of Violence", videoId: "3AF9Rjki0DE"},
      {title: "Personal Safety Planning", videoId: "AfWHGpwWE1o"},
      {title: "How to Support Survivors", videoId: "MsMlM-xyf5k"},
      {title: "Violence in Refugee Settings", videoId: "wscDqSSJBxI"},
      {title: "Building Safe Spaces", videoId: "kqHBaej2cBA"},
      {title: "Reporting Cases", videoId: "7ijfkDyw6sA"},
      {title: "Community Leadership", videoId: "ZcU6t9z4-3w"},
      {title: "Mental Health & Recovery", videoId: "Wibnx1JEb5U"},
      {title: "Legal Rights of Survivors", videoId: "26u5xHyNFLs"},
      {title: "Youth Role in Prevention", videoId: "ebxkz_BR1zM"},
      {title: "Healing and Moving Forward", videoId: "uxyUxFxdRKc"}
    ];

    const questionBank = [
      {question: "What is one form of gender-based violence?", options: ["Just physical hitting", "Forced Marriage", "Playing with friends", "Studying"], answer: 1},
      {question: "If you experience violence, the first safe step is:", options: ["Silence", "Tell someone you trust", "Fight back immediately", "Forget about it"], answer: 1}
    ];

    let currentModule = 0;
    let currentUser = localStorage.getItem('gs_user_name') || null;
    let players = {}; // Store YouTube players

    // --- Auth Logic ---
    function updateAuthUI() {
      const authSection = document.getElementById('auth-section');
      const greeting = document.getElementById('user-greeting');
      
      if (currentUser) {
        greeting.textContent = `Welcome back, ${currentUser}`;
        authSection.innerHTML = `
          <div class="flex items-center gap-3">
            <span class="text-sm text-purple-700 font-semibold hidden md:inline">${currentUser}</span>
            <button onclick="logout()" class="text-xs border border-red-200 px-2 py-1 rounded text-red-500 hover:bg-red-50" data-i18n="logout">Logout</button>
          </div>
        `;
      } else {
        greeting.textContent = translations[getCurrentLanguage()].guest_user || "Guest User (Progress not saved)";
        authSection.innerHTML = `
          <button onclick="openLoginModal()" class="text-purple-700 font-semibold hover:text-pink-600 flex items-center gap-2 text-sm">
            <i class="fas fa-user-circle text-lg"></i> <span data-i18n="login">Log In</span>
          </button>
        `;
      }
      
      // Re-apply translations after updating auth section
      applyTranslations(getCurrentLanguage());
    }

    function openLoginModal() { document.getElementById('login-modal').classList.remove('hidden'); }
    function closeLoginModal() { document.getElementById('login-modal').classList.add('hidden'); }
    
    document.getElementById('login-form').addEventListener('submit', function(e) {
      e.preventDefault();
      const name = document.getElementById('username-input').value;
      if(name) { 
        currentUser = name; 
        localStorage.setItem('gs_user_name', name); 
        updateAuthUI(); 
        closeLoginModal(); 
        renderModules(); 
      }
    });

    function logout() { 
      if(confirm("Logout?")) { 
        localStorage.removeItem('gs_user_name'); 
        currentUser = null; 
        window.location.reload(); 
      } 
    }

    // --- Helper Functions ---
    function getStorageKey(index, type = 'quiz') {
        const userSuffix = currentUser ? `_${currentUser}` : '';
        return `gbv-${type}-${index}${userSuffix}`;
    }

    // --- Main Render Logic ---
    function renderModules() {
      const container = document.getElementById('modules-container');
      container.innerHTML = '';
      let allPassed = true;

      modules.forEach((mod, i) => {
        const prevQuizKey = getStorageKey(i-1, 'quiz');
        const thisQuizKey = getStorageKey(i, 'quiz');
        const thisWatchedKey = getStorageKey(i, 'watched');

        const prevPassed = i === 0 || localStorage.getItem(prevQuizKey) === 'true';
        const thisPassed = localStorage.getItem(thisQuizKey) === 'true';
        const hasWatched = localStorage.getItem(thisWatchedKey) === 'true';
        
        const isModuleLocked = i > 0 && !prevPassed;
        if (!thisPassed) allPassed = false;

        container.innerHTML += `
          <div class="bg-white rounded-3xl shadow-xl overflow-hidden ${isModuleLocked ? 'module-locked' : ''} transition-all hover:-translate-y-4 flex flex-col h-full">
            <div class="bg-gradient-to-r from-pink-500 to-purple-600 text-white p-6 flex justify-between items-center">
              <h3 class="text-xl font-bold">Module ${i+1}</h3>
              ${thisPassed ? '<i class="fas fa-check-circle text-3xl text-green-300"></i>' : '<i class="fas fa-play-circle text-3xl"></i>'}
            </div>
            
            <div class="p-8 flex-1 flex flex-col">
              <h4 class="text-xl font-bold text-purple-700 mb-5 flex-1">${mod.title}</h4>
              
              <div class="video-container mb-6 shadow-lg rounded-2xl overflow-hidden">
                 ${hasWatched ? 
                    `<iframe src="https://www.youtube.com/embed/${mod.videoId}" allowfullscreen></iframe>` :
                    `<div id="player-wrapper-${i}" class="w-full h-full">
                        <div class="overlay" onclick="initPlayer(${i}, '${mod.videoId}')">
                            <div class="play-icon w-16 h-16 bg-pink-600 rounded-full flex items-center justify-center shadow-lg text-white transition-transform duration-300">
                                <i class="fas fa-play text-2xl ml-1"></i>
                            </div>
                        </div>
                        <div id="yt-player-${i}"></div>
                     </div>`
                 }
              </div>

              <div id="action-area-${i}">
                  ${thisPassed ? 
                    `<button onclick="startQuiz(${i})" class="w-full gradient-btn text-white py-4 rounded-2xl font-bold text-lg">Completed (Retake)</button>` :
                    (hasWatched ? 
                        `<button onclick="startQuiz(${i})" class="w-full gradient-btn text-white py-4 rounded-2xl font-bold text-lg animate-pulse">Start Quiz (2 Qs)</button>` :
                        `<div class="text-center p-3 bg-gray-100 rounded-xl text-gray-500 font-medium text-sm">
                            <i class="fas fa-eye mr-2"></i> Watch full video to unlock quiz
                         </div>`
                    )
                  }
              </div>
            </div>
          </div>`;
      });

      updateProgress();
      updateAuthUI();

      if (allPassed) document.getElementById('completion-section').classList.remove('hidden');
      else document.getElementById('completion-section').classList.add('hidden');
    }

    // --- YouTube API Logic ---
    function initPlayer(index, videoId) {
        const wrapper = document.getElementById(`player-wrapper-${index}`);
        wrapper.querySelector('.overlay').style.display = 'none';

        players[index] = new YT.Player(`yt-player-${index}`, {
            height: '100%',
            width: '100%',
            videoId: videoId,
            playerVars: { 'autoplay': 1, 'rel': 0 },
            events: {
                'onStateChange': (event) => onPlayerStateChange(event, index)
            }
        });
    }

    function onPlayerStateChange(event, index) {
        if (event.data === YT.PlayerState.ENDED) {
            unlockQuiz(index);
        }
    }

    function unlockQuiz(index) {
        localStorage.setItem(getStorageKey(index, 'watched'), 'true');
        const actionArea = document.getElementById(`action-area-${index}`);
        
        actionArea.innerHTML = `
            <div class="text-center mb-2 text-green-600 font-bold animate-bounce">Video Completed!</div>
            <button onclick="startQuiz(${index})" class="w-full gradient-btn text-white py-4 rounded-2xl font-bold text-lg shadow-xl">
                Start Quiz (2 Qs)
            </button>
        `;
    }

    // --- Quiz & Logic ---
    function startQuiz(index) {
        currentModule = index;
        const shuffled = [...questionBank].sort(() => Math.random() - 0.5).slice(0, 2);
        document.body.insertAdjacentHTML('beforeend', `
            <div id="quiz-modal" class="fixed inset-0 bg-black/85 z-[60] flex items-center justify-center p-4">
            <div class="bg-white rounded-3xl max-w-4xl w-full p-10 relative">
                <button onclick="document.getElementById('quiz-modal').remove()" class="absolute top-4 right-4 text-2xl text-gray-400 hover:text-red-500"><i class="fas fa-times"></i></button>
                <h2 class="text-3xl font-bold text-center text-purple-700 mb-8">Module ${index+1} Quiz</h2>
                <div class="grid md:grid-cols-2 gap-6" id="quiz-questions"></div>
                <button onclick="submitQuiz()" class="w-full gradient-btn text-white py-4 rounded-xl mt-8 font-bold text-xl">Submit</button>
            </div></div>
        `);
        const container = document.getElementById('quiz-questions');
        shuffled.forEach((q, i) => {
            container.innerHTML += `<div class="quiz-card p-6 border border-gray-100 bg-purple-50 rounded-xl"><p class="font-bold mb-4">${i+1}. ${q.question}</p><div class="space-y-2">${q.options.map((o,j)=>`<label class="flex items-center gap-3 p-3 bg-white rounded-lg border cursor-pointer hover:border-pink-500"><input type="radio" name="q${i}" value="${j}" class="text-pink-600"><span>${o}</span></label>`).join('')}</div></div>`;
        });
    }

    function submitQuiz() {
        const answers = document.querySelectorAll('#quiz-modal input:checked');
        if (answers.length < 2) return alert("Answer all questions");
        let correct = 0;
        answers.forEach(a => {
             const qText = a.closest('.quiz-card').querySelector('p').textContent.split('. ')[1];
             if(parseInt(a.value) === questionBank.find(q=>q.question===qText).answer) correct++;
        });
        
        if(correct >= 1) {
            localStorage.setItem(getStorageKey(currentModule, 'quiz'), 'true');
            alert("Passed!");
            document.getElementById('quiz-modal').remove();
            renderModules();
        } else {
            alert("Try again.");
        }
    }

    function updateProgress() {
      const done = modules.filter((_,i) => localStorage.getItem(getStorageKey(i, 'quiz'))).length;
      const perc = Math.round((done / modules.length) * 100);
      document.getElementById('progress-fill').style.width = perc + '%';
      document.getElementById('progress-text').textContent = perc + '%';
    }

    // --- Certificate ---
    function showCertificate() {
      document.getElementById('cert-name').textContent = currentUser || "Student";
      document.getElementById('cert-date').textContent = new Date().toLocaleDateString();
      document.getElementById('certificate-modal').classList.remove('hidden');
    }
    
    function downloadPDF() {
        const btn = document.querySelector('#certificate-modal button.gradient-btn');
        btn.innerHTML = 'Generating...';
        html2pdf().set({ margin: 0.5, filename: 'Certificate.pdf', image: { type: 'jpeg', quality: 0.98 }, html2canvas: { scale: 2 }, jsPDF: { unit: 'in', format: 'letter', orientation: 'landscape' } }).from(document.getElementById('certificate-content')).save().then(() => btn.innerHTML = '<i class="fas fa-file-pdf mr-2"></i> ' + (translations[getCurrentLanguage()].download_pdf || 'Download PDF'));
    }

    // --- Initialize Everything ---
    document.addEventListener('DOMContentLoaded', function() {
      const currentLang = getCurrentLanguage();
      console.log('Initializing with language:', currentLang);
      
      // Apply translations
      applyTranslations(currentLang);
      updateLanguageSelector(currentLang);
      updatePageDirection(currentLang);
      
      // Add event listeners for mobile menu
      const hamburger = document.getElementById('hamburger');
      const overlay = document.getElementById('mobile-menu-overlay');
      
      if (hamburger) {
        hamburger.addEventListener('click', toggleMenu);
      }
      
      if (overlay) {
        overlay.addEventListener('click', toggleMenu);
      }
      
      // Mobile language selector event
      const mobileLanguageSelector = document.getElementById('mobile-language-selector');
      if (mobileLanguageSelector) {
        mobileLanguageSelector.addEventListener('change', function() {
          changeLanguage(this.value);
        });
      }

      // Add click events to desktop language buttons
      document.querySelectorAll('#language-button + ul button').forEach(button => {
        button.addEventListener('click', function() {
          const lang = this.getAttribute('onclick').match(/'([^']+)'/)[1];
          changeLanguage(lang);
        });
      });

      // Render modules
      renderModules();
    });
  </script>
  <script type="module" src="./auth-ui.js"></script>
</body>
</html>