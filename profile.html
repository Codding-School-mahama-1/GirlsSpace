<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>My Profile - GirlsSpace Mahama</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Poppins:wght@400;500;600;700;900&display=swap" rel="stylesheet">
 
  <script src="https://cdn.tailwindcss.com"></script>
 
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            poppins: ['Poppins', 'sans-serif'],
            inter: ['Inter', 'sans-serif'],
          },
          colors: {
            primary: '#ec4899',
            'primary-dark': '#be185d',
            accent: '#fbbf24',
            dark: '#0f0f14',
            'custom-purple': '#c23cb6',
          },
          animation: {
            fadeIn: 'fadeIn 0.5s ease-in-out',
          },
          keyframes: {
            fadeIn: {
              '0%': { opacity: 0, transform: 'translateY(-10px)' },
              '100%': { opacity: 1, transform: 'translateY(0)' },
            }
          }
        }
      }
    }
  </script>

  <style>
    /* Custom styles */
    .profile-section {
      background: linear-gradient(135deg, #1a1a1a 0%, #2d1b69 100%);
    }
   
    .progress-ring {
      transform: rotate(-90deg);
    }
   
    .progress-ring-circle {
      transition: stroke-dashoffset 0.5s ease;
    }
   
    .badge {
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
   
    .achievement-card {
      transition: all 0.3s ease;
    }
   
    .achievement-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(236, 72, 153, 0.2);
    }
   
    .tab-button.active {
      border-bottom: 3px solid #ec4899;
      color: #ec4899;
      font-weight: 600;
    }
   
    .story-card {
      transition: all 0.3s ease;
    }
   
    .story-card:hover {
      transform: translateY(-3px);
    }
  </style>
</head>

<body class="font-poppins bg-black text-white min-h-screen">

  <!-- Navigation (Same as your main page) -->
  <nav class="flex items-center justify-between px-5 py-3 bg-white sticky top-0 z-50 shadow-md md:px-10">
    <div class="w-[60px] h-[50px]">
      <img src="./img/Girls Space (1) (1).png" onerror="this.src='https://via.placeholder.com/60'" alt="Logo" class="w-full h-full object-contain rounded-full">
    </div>

    <div class="hidden lg:flex items-center gap-6 text-sm font-medium text-gray-700">
      <a href="./index.html" class="nav-link hover:text-primary relative transition-colors">Home</a>
      <a href="./AboutUs.html" class="nav-link hover:text-primary relative transition-colors">About</a>
      <a href="./chat.html" class="nav-link hover:text-primary relative transition-colors">Chat</a>
      <a href="./stories.html" class="nav-link hover:text-primary relative transition-colors">Stories</a>
      <a href="./Learning_Programs.html" class="nav-link hover:text-primary relative transition-colors">Programs</a>
      <a href="./protection.html" class="nav-link hover:text-primary relative transition-colors">Protection</a>
      <a href="./profile.html" class="nav-link hover:text-primary relative transition-colors text-primary font-semibold">My Profile</a>
     
      <div class="relative group">
        <button class="flex items-center hover:text-primary transition-colors py-2" id="language-button">
          <span id="current-language">English</span> <i class="fas fa-chevron-down ml-1 text-xs"></i>
        </button>
        <ul class="absolute top-full left-0 bg-white shadow-xl rounded-lg w-32 hidden group-hover:block py-2 border border-gray-100">
          <li><a href="#" class="block px-4 py-2 hover:bg-purple-50 hover:text-custom-purple text-gray-700 language-option" data-lang="en">English</a></li>
          <li><a href="#" class="block px-4 py-2 hover:bg-purple-50 hover:text-custom-purple text-gray-700 language-option" data-lang="ar">Arabic</a></li>
          <li><a href="#" class="block px-4 py-2 hover:bg-purple-50 hover:text-custom-purple text-gray-700 language-option" data-lang="sw">Swahili</a></li>
          <li><a href="#" class="block px-4 py-2 hover:bg-purple-50 hover:text-custom-purple text-gray-700 language-option" data-lang="fr">French</a></li>
          <li><a href="#" class="block px-4 py-2 hover:bg-purple-50 hover:text-custom-purple text-gray-700 language-option" data-lang="rw">Kinyarwanda</a></li>
        </ul>
      </div>
     
      <button id="logoutBtn" class="px-4 py-1.5 border-[1.5px] border-red-500 text-red-500 rounded-full text-sm font-semibold hover:bg-red-50 transition-colors hidden">
        <i class="fas fa-sign-out-alt mr-2"></i>Log Out
      </button>
     
      <a href="./donate.html" class="px-5 py-2 bg-gradient-to-r from-[#ff5f8d] to-[#c23cb6] text-white rounded-full text-sm font-semibold hover:shadow-lg hover:shadow-pink-200 transition-all border border-transparent hover:border-custom-purple">Donate</a>
    </div>

    <button id="hamburger" class="lg:hidden flex flex-col gap-1.5 z-50 cursor-pointer group">
      <span class="w-7 h-[3px] bg-gray-700 rounded-full transition-all duration-300 group-[.active]:rotate-45 group-[.active]:translate-y-2"></span>
      <span class="w-7 h-[3px] bg-gray-700 rounded-full transition-all duration-300 group-[.active]:opacity-0"></span>
      <span class="w-7 h-[3px] bg-gray-700 rounded-full transition-all duration-300 group-[.active]:-rotate-45 group-[.active]:-translate-y-2.5"></span>
    </button>
  </nav>

  <!-- Mobile Menu (Similar structure to main page) -->
  <div id="mobile-menu-overlay" class="fixed inset-0 bg-black/50 z-40 hidden lg:hidden backdrop-blur-sm"></div>
  <div id="mobile-menu" class="fixed top-0 left-[-100%] w-full h-full bg-white z-40 transition-all duration-300 lg:hidden overflow-y-auto">
    <div class="pt-20 px-6 pb-10">
      <div class="flex flex-col gap-6 text-gray-700 font-medium">
        <a href="./index.html" class="py-2 border-b border-gray-100 hover:text-primary transition-colors">Home</a>
        <a href="./AboutUs.html" class="py-2 border-b border-gray-100 hover:text-primary transition-colors">About</a>
        <a href="./chat.html" class="py-2 border-b border-gray-100 hover:text-primary transition-colors">Chat</a>
        <a href="./stories.html" class="py-2 border-b border-gray-100 hover:text-primary transition-colors">Stories</a>
        <a href="./Learning_Programs.html" class="py-2 border-b border-gray-100 hover:text-primary transition-colors">Programs</a>
        <a href="./Protection.html" class="py-2 border-b border-gray-100 hover:text-primary transition-colors">Protection</a>
        <a href="./profile.html" class="py-2 border-b border-gray-100 text-primary font-semibold transition-colors">My Profile</a>
       
        <button id="mobileLogoutBtn" class="py-2 border-b border-gray-100 text-red-500 text-left hidden">
          <i class="fas fa-sign-out-alt mr-2"></i>Log Out
        </button>
       
        <a href="./donate.html" class="px-4 py-2 bg-gradient-to-r from-[#ff5f8d] to-[#c23cb6] text-white rounded-full text-sm font-semibold hover:shadow-lg hover:shadow-pink-200 transition-all text-center">Donate</a>
      </div>
    </div>
  </div>

  <!-- Main Profile Content -->
  <main class="min-h-screen bg-gradient-to-b from-dark to-gray-900 pb-16">
    <!-- Profile Header -->
    <div class="profile-section pt-12 pb-8 px-6">
      <div class="max-w-6xl mx-auto">
        <div class="flex flex-col lg:flex-row items-center lg:items-start gap-8">
          <!-- Profile Picture -->
          <div class="relative">
            <div class="w-40 h-40 rounded-full border-4 border-primary overflow-hidden bg-gradient-to-br from-purple-500 to-pink-500">
              <img id="profileImage" src="https://via.placeholder.com/160" alt="Profile" class="w-full h-full object-cover">
            </div>
            <button id="editPictureBtn" class="absolute bottom-2 right-2 w-10 h-10 bg-primary rounded-full flex items-center justify-center text-white hover:bg-primary-dark transition-colors">
              <i class="fas fa-camera"></i>
            </button>
          </div>
         
          <!-- Profile Info -->
          <div class="flex-1 text-center lg:text-left">
            <div class="flex flex-col lg:flex-row lg:items-center justify-between gap-4 mb-4">
              <div>
                <h1 id="userName" class="text-3xl lg:text-4xl font-bold mb-2">Loading...</h1>
                <p class="text-gray-300 mb-2">Mahama Refugee Camp</p>
                <div class="flex items-center justify-center lg:justify-start gap-3 mb-4">
                  <span class="px-3 py-1 bg-primary/20 text-primary rounded-full text-sm font-medium">Member since 2024</span>
                  <span class="px-3 py-1 bg-accent/20 text-accent rounded-full text-sm font-medium">Level 3 Explorer</span>
                </div>
              </div>
             
              <button id="editProfileBtn" class="px-5 py-2.5 border border-primary text-primary rounded-full font-semibold hover:bg-primary hover:text-white transition-all duration-300">
                <i class="fas fa-edit mr-2"></i>Edit Profile
              </button>
            </div>
           
            <!-- Stats -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
              <div class="bg-white/5 rounded-xl p-4 text-center">
                <div class="text-2xl font-bold text-primary">0</div>
                <div class="text-sm text-gray-300"data-translate="profile.stories">Stories Shared</div>
              </div>
              <div class="bg-white/5 rounded-xl p-4 text-center">
                <div class="text-2xl font-bold text-accent">156</div>
                <div class="text-sm text-gray-300">Chat Messages</div>
              </div>
              <div class="bg-white/5 rounded-xl p-4 text-center">
                <div class="text-2xl font-bold text-green-400">8</div>
                <div class="text-sm text-gray-300">Programs Completed</div>
              </div>
              <div class="bg-white/5 rounded-xl p-4 text-center">
                <div class="text-2xl font-bold text-purple-400">5</div>
                <div class="text-sm text-gray-300">Badges Earned</div>
              </div>
            </div>
           
            <!-- Bio -->
            <p id="userBio" class="text-gray-300 max-w-2xl">
              Passionate about education and women empowerment. I love sharing stories and learning new skills through GirlsSpace programs.
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Tabs Navigation -->
    <div class="max-w-6xl mx-auto px-6">
      <div class="border-b border-gray-700 mb-8">
        <div class="flex overflow-x-auto no-scrollbar">
          <button class="tab-button active px-6 py-4 text-lg font-medium transition-all" data-tab="overview">
            <i class="fas fa-home mr-2"></i>Overview
          </button>
          <button class="tab-button px-6 py-4 text-lg font-medium transition-all" data-tab="stories">
            <i class="fas fa-book-open mr-2"></i>My Stories
          </button>
          <button class="tab-button px-6 py-4 text-lg font-medium transition-all" data-tab="progress">
            <i class="fas fa-chart-line mr-2"></i>Progress
          </button>
          <button class="tab-button px-6 py-4 text-lg font-medium transition-all" data-tab="achievements">
            <i class="fas fa-trophy mr-2"></i>Achievements
          </button>
          <button class="tab-button px-6 py-4 text-lg font-medium transition-all" data-tab="settings">
            <i class="fas fa-cog mr-2"></i>Settings
          </button>
        </div>
      </div>
    </div>

    <!-- Tab Content -->
    <div class="max-w-6xl mx-auto px-6">
     
      <!-- Overview Tab -->
      <div id="overview-tab" class="tab-content animate-fadeIn">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
          <!-- Left Column -->
          <div class="lg:col-span-2 space-y-8">
            <!-- Recent Activity -->
            <div class="bg-gradient-to-br from-gray-900 to-dark rounded-2xl p-6 border border-gray-800">
              <h2 class="text-2xl font-bold mb-6 flex items-center">
                <i class="fas fa-history text-primary mr-3"></i>Recent Activity
              </h2>
              <div class="space-y-4">
                <div class="flex items-center gap-4 p-4 bg-white/5 rounded-xl">
                  <div class="w-12 h-12 rounded-full bg-primary/20 flex items-center justify-center">
                    <i class="fas fa-comment text-primary"></i>
                  </div>
                  <div class="flex-1">
                    <p class="font-medium">Posted a new story</p>
                    <p class="text-sm text-gray-400">"My journey learning English"</p>
                  </div>
                  <span class="text-sm text-gray-400">2 hours ago</span>
                </div>
               
                <div class="flex items-center gap-4 p-4 bg-white/5 rounded-xl">
                  <div class="w-12 h-12 rounded-full bg-green-500/20 flex items-center justify-center">
                    <i class="fas fa-graduation-cap text-green-400"></i>
                  </div>
                  <div class="flex-1">
                    <p class="font-medium">Completed program</p>
                    <p class="text-sm text-gray-400">Life Skills: Communication</p>
                  </div>
                  <span class="text-sm text-gray-400">Yesterday</span>
                </div>
               
                <div class="flex items-center gap-4 p-4 bg-white/5 rounded-xl">
                  <div class="w-12 h-12 rounded-full bg-accent/20 flex items-center justify-center">
                    <i class="fas fa-comments text-accent"></i>
                  </div>
                  <div class="flex-1">
                    <p class="font-medium">Active in chat room</p>
                    <p class="text-sm text-gray-400">Women in Tech discussion</p>
                  </div>
                  <span class="text-sm text-gray-400">2 days ago</span>
                </div>
              </div>
            </div>
           
            <!-- My Stories Preview -->
            <div class="bg-gradient-to-br from-gray-900 to-dark rounded-2xl p-6 border border-gray-800">
              <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold flex items-center">
                  <i class="fas fa-book-open text-primary mr-3"></i>My Stories
                </h2>
                <a href="./stories.html" class="text-primary hover:text-primary-dark transition-colors">View All</a>
              </div>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="story-card bg-white/5 rounded-xl p-4 hover:bg-white/10 transition-all">
                  <h3 class="font-bold mb-2">Overcoming Challenges</h3>
                  <p class="text-sm text-gray-400 mb-3">How I found strength in difficult times...</p>
                  <div class="flex justify-between items-center">
                    <span class="text-xs text-gray-500">15 likes • 3 comments</span>
                    <span class="text-xs text-primary">Published</span>
                  </div>
                </div>
               
                <div class="story-card bg-white/5 rounded-xl p-4 hover:bg-white/10 transition-all">
                  <h3 class="font-bold mb-2">Learning Journey</h3>
                  <p class="text-sm text-gray-400 mb-3">My progress in language classes...</p>
                  <div class="flex justify-between items-center">
                    <span class="text-xs text-gray-500">28 likes • 7 comments</span>
                    <span class="text-xs text-yellow-500">Draft</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
         
          <!-- Right Column -->
          <div class="space-y-8">
            <!-- Progress Summary -->
            <div class="bg-gradient-to-br from-gray-900 to-dark rounded-2xl p-6 border border-gray-800">
              <h2 class="text-2xl font-bold mb-6 flex items-center">
                <i class="fas fa-chart-line text-primary mr-3"></i>Learning Progress
              </h2>
             
              <div class="space-y-6">
                <!-- English Progress -->
                <div>
                  <div class="flex justify-between mb-2">
                    <span class="font-medium">English Language</span>
                    <span class="text-primary font-bold">75%</span>
                  </div>
                  <div class="h-2 bg-gray-700 rounded-full overflow-hidden">
                    <div class="h-full bg-primary rounded-full" style="width: 75%"></div>
                  </div>
                </div>
               
                <!-- Life Skills Progress -->
                <div>
                  <div class="flex justify-between mb-2">
                    <span class="font-medium">Life Skills</span>
                    <span class="text-green-400 font-bold">90%</span>
                  </div>
                  <div class="h-2 bg-gray-700 rounded-full overflow-hidden">
                    <div class="h-full bg-green-500 rounded-full" style="width: 90%"></div>
                  </div>
                </div>
               
                <!-- GBV Prevention Progress -->
                <div>
                  <div class="flex justify-between mb-2">
                    <span class="font-medium">GBV Prevention</span>
                    <span class="text-purple-400 font-bold">60%</span>
                  </div>
                  <div class="h-2 bg-gray-700 rounded-full overflow-hidden">
                    <div class="h-full bg-purple-500 rounded-full" style="width: 60%"></div>
                  </div>
                </div>
               
                <!-- Digital Skills Progress -->
                <div>
                  <div class="flex justify-between mb-2">
                    <span class="font-medium">Digital Skills</span>
                    <span class="text-accent font-bold">45%</span>
                  </div>
                  <div class="h-2 bg-gray-700 rounded-full overflow-hidden">
                    <div class="h-full bg-accent rounded-full" style="width: 45%"></div>
                  </div>
                </div>
              </div>
             
              <a href="./Learning_Programs.html" class="mt-6 block text-center px-4 py-3 bg-primary/20 text-primary rounded-xl font-medium hover:bg-primary/30 transition-colors">
                <i class="fas fa-play-circle mr-2"></i>Continue Learning
              </a>
            </div>
           
            <!-- Quick Actions -->
            <div class="bg-gradient-to-br from-gray-900 to-dark rounded-2xl p-6 border border-gray-800">
              <h2 class="text-2xl font-bold mb-6 flex items-center">
                <i class="fas fa-bolt text-accent mr-3"></i>Quick Actions
              </h2>
             
              <div class="space-y-3">
                <a href="./chat.html" class="flex items-center gap-3 p-3 bg-white/5 rounded-xl hover:bg-white/10 transition-all">
                  <div class="w-10 h-10 rounded-lg bg-primary/20 flex items-center justify-center">
                    <i class="fas fa-comment text-primary"></i>
                  </div>
                  <span>Join a Chat Room</span>
                </a>
               
                <a href="./stories.html" class="flex items-center gap-3 p-3 bg-white/5 rounded-xl hover:bg-white/10 transition-all">
                  <div class="w-10 h-10 rounded-lg bg-green-500/20 flex items-center justify-center">
                    <i class="fas fa-pen text-green-400"></i>
                  </div>
                  <span>Write a Story</span>
                </a>
               
                <a href="./Learning_Programs.html" class="flex items-center gap-3 p-3 bg-white/5 rounded-xl hover:bg-white/10 transition-all">
                  <div class="w-10 h-10 rounded-lg bg-purple-500/20 flex items-center justify-center">
                    <i class="fas fa-graduation-cap text-purple-400"></i>
                  </div>
                  <span>Start New Program</span>
                </a>
               
                <a href="./protection.html" class="flex items-center gap-3 p-3 bg-white/5 rounded-xl hover:bg-white/10 transition-all">
                  <div class="w-10 h-10 rounded-lg bg-red-500/20 flex items-center justify-center">
                    <i class="fas fa-shield-alt text-red-400"></i>
                  </div>
                  <span>Get Support</span>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
     
      <!-- My Stories Tab -->
      <div id="stories-tab" class="tab-content hidden animate-fadeIn">
        <div class="bg-gradient-to-br from-gray-900 to-dark rounded-2xl p-6 border border-gray-800">
          <div class="flex justify-between items-center mb-8">
            <h2 class="text-2xl font-bold">My Stories</h2>
            <a href="./stories.html?action=create" class="px-5 py-2.5 bg-primary text-white rounded-full font-semibold hover:bg-primary-dark transition-all">
              <i class="fas fa-plus mr-2"></i>Write New Story
            </a>
          </div>
         
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Story Cards will be dynamically loaded here -->
          </div>
         
          <div class="text-center py-8">
            <p class="text-gray-400">You haven't written any stories yet.</p>
            <a href="./stories.html?action=create" class="inline-block mt-4 text-primary hover:text-primary-dark">Start your first story →</a>
          </div>
        </div>
      </div>
     
      <!-- Progress Tab -->
      <div id="progress-tab" class="tab-content hidden animate-fadeIn">
        <div class="bg-gradient-to-br from-gray-900 to-dark rounded-2xl p-6 border border-gray-800">
          <h2 class="text-2xl font-bold mb-8">Learning Progress</h2>
         
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Program Progress -->
            <div>
              <h3 class="text-xl font-bold mb-6">Active Programs</h3>
              <div class="space-y-6">
                <!-- Program Item -->
                <div class="p-4 bg-white/5 rounded-xl">
                  <div class="flex items-center justify-between mb-3">
                    <div class="flex items-center gap-3">
                      <div class="w-12 h-12 rounded-lg bg-primary/20 flex items-center justify-center">
                        <i class="fas fa-language text-primary"></i>
                      </div>
                      <div>
                        <h4 class="font-bold">English Language</h4>
                        <p class="text-sm text-gray-400">Beginner to Intermediate</p>
                      </div>
                    </div>
                    <span class="text-primary font-bold">75%</span>
                  </div>
                  <div class="h-2 bg-gray-700 rounded-full overflow-hidden">
                    <div class="h-full bg-primary rounded-full" style="width: 75%"></div>
                  </div>
                </div>
               
                <!-- Program Item -->
                <div class="p-4 bg-white/5 rounded-xl">
                  <div class="flex items-center justify-between mb-3">
                    <div class="flex items-center gap-3">
                      <div class="w-12 h-12 rounded-lg bg-green-500/20 flex items-center justify-center">
                        <i class="fas fa-hands-helping text-green-400"></i>
                      </div>
                      <div>
                        <h4 class="font-bold">Life Skills</h4>
                        <p class="text-sm text-gray-400">Communication & Leadership</p>
                      </div>
                    </div>
                    <span class="text-green-400 font-bold">90%</span>
                  </div>
                  <div class="h-2 bg-gray-700 rounded-full overflow-hidden">
                    <div class="h-full bg-green-500 rounded-full" style="width: 90%"></div>
                  </div>
                </div>
              </div>
            </div>
           
            <!-- Stats Chart -->
            <div>
              <h3 class="text-xl font-bold mb-6">Learning Statistics</h3>
              <div class="grid grid-cols-2 gap-4">
                <div class="bg-white/5 rounded-xl p-4 text-center">
                  <div class="text-3xl font-bold text-primary">42</div>
                  <div class="text-sm text-gray-300">Hours Learned</div>
                </div>
                <div class="bg-white/5 rounded-xl p-4 text-center">
                  <div class="text-3xl font-bold text-accent">18</div>
                  <div class="text-sm text-gray-300">Lessons Completed</div>
                </div>
                <div class="bg-white/5 rounded-xl p-4 text-center">
                  <div class="text-3xl font-bold text-green-400">8</div>
                  <div class="text-sm text-gray-300">Certificates</div>
                </div>
                <div class="bg-white/5 rounded-xl p-4 text-center">
                  <div class="text-3xl font-bold text-purple-400">92%</div>
                  <div class="text-sm text-gray-300">Average Score</div>
                </div>
              </div>
             
              <div class="mt-8">
                <h4 class="font-bold mb-4">Weekly Activity</h4>
                <div class="flex items-end justify-between h-32">
                  <div class="flex flex-col items-center">
                    <div class="w-6 bg-primary rounded-t" style="height: 60%"></div>
                    <span class="text-xs mt-2">Mon</span>
                  </div>
                  <div class="flex flex-col items-center">
                    <div class="w-6 bg-primary rounded-t" style="height: 80%"></div>
                    <span class="text-xs mt-2">Tue</span>
                  </div>
                  <div class="flex flex-col items-center">
                    <div class="w-6 bg-primary rounded-t" style="height: 45%"></div>
                    <span class="text-xs mt-2">Wed</span>
                  </div>
                  <div class="flex flex-col items-center">
                    <div class="w-6 bg-primary rounded-t" style="height: 90%"></div>
                    <span class="text-xs mt-2">Thu</span>
                  </div>
                  <div class="flex flex-col items-center">
                    <div class="w-6 bg-primary rounded-t" style="height: 70%"></div>
                    <span class="text-xs mt-2">Fri</span>
                  </div>
                  <div class="flex flex-col items-center">
                    <div class="w-6 bg-primary rounded-t" style="height: 85%"></div>
                    <span class="text-xs mt-2">Sat</span>
                  </div>
                  <div class="flex flex-col items-center">
                    <div class="w-6 bg-primary rounded-t" style="height: 50%"></div>
                    <span class="text-xs mt-2">Sun</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
     
      <!-- Achievements Tab -->
      <div id="achievements-tab" class="tab-content hidden animate-fadeIn">
        <div class="bg-gradient-to-br from-gray-900 to-dark rounded-2xl p-6 border border-gray-800">
          <h2 class="text-2xl font-bold mb-8">My Achievements</h2>
         
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <!-- Badge 1 -->
            <div class="achievement-card bg-gradient-to-br from-purple-900/30 to-pink-900/30 rounded-2xl p-6 text-center border border-purple-500/30">
              <div class="w-20 h-20 mx-auto mb-4 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center">
                <i class="fas fa-star text-white text-2xl"></i>
              </div>
              <h3 class="font-bold text-lg mb-2">First Story</h3>
              <p class="text-sm text-gray-300 mb-3">Shared your first story</p>
              <span class="text-xs text-accent font-medium">Earned: Jan 15, 2024</span>
            </div>
           
            <!-- Badge 2 -->
            <div class="achievement-card bg-gradient-to-br from-green-900/30 to-emerald-900/30 rounded-2xl p-6 text-center border border-green-500/30">
              <div class="w-20 h-20 mx-auto mb-4 rounded-full bg-gradient-to-br from-green-500 to-emerald-500 flex items-center justify-center">
                <i class="fas fa-graduation-cap text-white text-2xl"></i>
              </div>
              <h3 class="font-bold text-lg mb-2">Quick Learner</h3>
              <p class="text-sm text-gray-300 mb-3">Completed 5 programs</p>
              <span class="text-xs text-accent font-medium">Earned: Feb 3, 2024</span>
            </div>
           
            <!-- Badge 3 -->
            <div class="achievement-card bg-gradient-to-br from-blue-900/30 to-cyan-900/30 rounded-2xl p-6 text-center border border-blue-500/30">
              <div class="w-20 h-20 mx-auto mb-4 rounded-full bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center">
                <i class="fas fa-comments text-white text-2xl"></i>
              </div>
              <h3 class="font-bold text-lg mb-2">Community Builder</h3>
              <p class="text-sm text-gray-300 mb-3">100+ chat messages</p>
              <span class="text-xs text-accent font-medium">Earned: Mar 10, 2024</span>
            </div>
           
            <!-- Badge 4 -->
            <div class="achievement-card bg-gradient-to-br from-yellow-900/30 to-orange-900/30 rounded-2xl p-6 text-center border border-yellow-500/30">
              <div class="w-20 h-20 mx-auto mb-4 rounded-full bg-gradient-to-br from-yellow-500 to-orange-500 flex items-center justify-center">
                <i class="fas fa-trophy text-white text-2xl"></i>
              </div>
              <h3 class="font-bold text-lg mb-2">Level 3 Explorer</h3>
              <p class="text-sm text-gray-300 mb-3">Active for 3 months</p>
              <span class="text-xs text-accent font-medium">Earned: Apr 22, 2024</span>
            </div>
          </div>
         
          <div class="bg-white/5 rounded-xl p-6">
            <h3 class="text-xl font-bold mb-4">Next Goals</h3>
            <div class="space-y-4">
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                  <div class="w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center">
                    <i class="fas fa-language"></i>
                  </div>
                  <div>
                    <p class="font-medium">Complete English Course</p>
                    <p class="text-sm text-gray-400">25% remaining</p>
                  </div>
                </div>
                <span class="text-primary font-bold">25%</span>
              </div>
             
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                  <div class="w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center">
                    <i class="fas fa-pen"></i>
                  </div>
                  <div>
                    <p class="font-medium">Write 5 more stories</p>
                    <p class="text-sm text-gray-400">3/5 completed</p>
                  </div>
                </div>
                <span class="text-green-400 font-bold">60%</span>
              </div>
            </div>
          </div>
        </div>
      </div>
     
      <!-- Settings Tab -->
      <div id="settings-tab" class="tab-content hidden animate-fadeIn">
        <div class="bg-gradient-to-br from-gray-900 to-dark rounded-2xl p-6 border border-gray-800">
          <h2 class="text-2xl font-bold mb-8">Account Settings</h2>
         
          <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Profile Settings -->
            <div class="lg:col-span-2">
              <h3 class="text-xl font-bold mb-6">Profile Information</h3>
             
              <form id="profileForm" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div>
                    <label class="block text-sm font-medium mb-2">First Name</label>
                    <input type="text" class="w-full px-4 py-3 bg-white/5 border border-gray-700 rounded-xl focus:border-primary focus:outline-none transition-colors" value="Sarah">
                  </div>
                 
                  <div>
                    <label class="block text-sm font-medium mb-2">Last Name</label>
                    <input type="text" class="w-full px-4 py-3 bg-white/5 border border-gray-700 rounded-xl focus:border-primary focus:outline-none transition-colors" value="M.">
                  </div>
                </div>
               
                <div>
                  <label class="block text-sm font-medium mb-2">Email</label>
                  <input type="email" class="w-full px-4 py-3 bg-white/5 border border-gray-700 rounded-xl focus:border-primary focus:outline-none transition-colors" value="sarah@example.com">
                </div>
               
                <div>
                  <label class="block text-sm font-medium mb-2">Location</label>
                  <select class="w-full px-4 py-3 bg-white/5 border border-gray-700 rounded-xl focus:border-primary focus:outline-none transition-colors">
                    <option>Mahama Refugee Camp</option>
                    <option>Nearby Community</option>
                    <option>Other</option>
                  </select>
                </div>
               
                <div>
                  <label class="block text-sm font-medium mb-2">Bio</label>
                  <textarea class="w-full px-4 py-3 bg-white/5 border border-gray-700 rounded-xl focus:border-primary focus:outline-none transition-colors resize-none h-32">Passionate about education and women empowerment. I love sharing stories and learning new skills through GirlsSpace programs.</textarea>
                </div>
               
                <div>
                  <label class="block text-sm font-medium mb-2">Preferred Language</label>
                  <select class="w-full px-4 py-3 bg-white/5 border border-gray-700 rounded-xl focus:border-primary focus:outline-none transition-colors">
                    <option value="en">English</option>
                    <option value="fr">French</option>
                    <option value="sw">Swahili</option>
                    <option value="rw">Kinyarwanda</option>
                    <option value="ar">Arabic</option>
                  </select>
                </div>
               
                <div class="flex gap-4 pt-4">
                  <button type="submit" class="px-6 py-3 bg-primary text-white rounded-xl font-semibold hover:bg-primary-dark transition-colors">
                    Save Changes
                  </button>
                  <button type="button" class="px-6 py-3 border border-gray-600 text-gray-300 rounded-xl font-semibold hover:bg-white/5 transition-colors">
                    Cancel
                  </button>
                </div>
              </form>
            </div>
           
            <!-- Account Management -->
            <div>
              <h3 class="text-xl font-bold mb-6">Account Management</h3>
             
              <div class="space-y-4">
                <div class="p-4 bg-white/5 rounded-xl">
                  <h4 class="font-bold mb-2">Privacy Settings</h4>
                  <div class="space-y-3">
                    <label class="flex items-center gap-2">
                      <input type="checkbox" class="w-4 h-4 text-primary bg-gray-700 border-gray-600 rounded" checked>
                      <span class="text-sm">Show my profile to others</span>
                    </label>
                    <label class="flex items-center gap-2">
                      <input type="checkbox" class="w-4 h-4 text-primary bg-gray-700 border-gray-600 rounded">
                      <span class="text-sm">Allow messages from others</span>
                    </label>
                    <label class="flex items-center gap-2">
                      <input type="checkbox" class="w-4 h-4 text-primary bg-gray-700 border-gray-600 rounded" checked>
                      <span class="text-sm">Show my activity</span>
                    </label>
                  </div>
                </div>
               
                <div class="p-4 bg-white/5 rounded-xl">
                  <h4 class="font-bold mb-2">Notification Preferences</h4>
                  <div class="space-y-3">
                    <label class="flex items-center gap-2">
                      <input type="checkbox" class="w-4 h-4 text-primary bg-gray-700 border-gray-600 rounded" checked>
                      <span class="text-sm">New messages</span>
                    </label>
                    <label class="flex items-center gap-2">
                      <input type="checkbox" class="w-4 h-4 text-primary bg-gray-700 border-gray-600 rounded" checked>
                      <span class="text-sm">Program updates</span>
                    </label>
                    <label class="flex items-center gap-2">
                      <input type="checkbox" class="w-4 h-4 text-primary bg-gray-700 border-gray-600 rounded">
                      <span class="text-sm">Community announcements</span>
                    </label>
                  </div>
                </div>
               
                <div class="space-y-3 pt-4">
                  <button class="w-full px-4 py-3 border border-gray-600 text-gray-300 rounded-xl font-medium hover:bg-white/5 transition-colors">
                    Change Password
                  </button>
                  <button id="deleteAccountBtn" class="w-full px-4 py-3 border border-red-600 text-red-400 rounded-xl font-medium hover:bg-red-500/10 transition-colors">
                    Delete Account
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Edit Profile Modal -->
  <div id="editProfileModal" class="fixed inset-0 bg-black/70 z-50 hidden items-center justify-center p-4">
    <div class="bg-gray-900 rounded-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto">
      <div class="p-6 border-b border-gray-800">
        <div class="flex justify-between items-center">
          <h2 class="text-2xl font-bold">Edit Profile</h2>
          <button id="closeEditModal" class="text-gray-400 hover:text-white">
            <i class="fas fa-times text-xl"></i>
          </button>
        </div>
      </div>
     
      <div class="p-6">
        <form id="editProfileForm" class="space-y-6">
          <div class="text-center">
            <div class="relative inline-block">
              <div class="w-32 h-32 rounded-full border-4 border-primary overflow-hidden bg-gradient-to-br from-purple-500 to-pink-500 mb-4 mx-auto">
                <img id="modalProfileImage" src="https://via.placeholder.com/128" alt="Profile" class="w-full h-full object-cover">
              </div>
              <input type="file" id="imageUpload" accept="image/*" class="hidden">
              <label for="imageUpload" class="absolute bottom-2 right-2 w-10 h-10 bg-primary rounded-full flex items-center justify-center text-white hover:bg-primary-dark transition-colors cursor-pointer">
                <i class="fas fa-camera"></i>
              </label>
            </div>
          </div>
         
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <label class="block text-sm font-medium mb-2">First Name</label>
              <input type="text" id="editFirstName" class="w-full px-4 py-3 bg-white/5 border border-gray-700 rounded-xl focus:border-primary focus:outline-none transition-colors">
            </div>
           
            <div>
              <label class="block text-sm font-medium mb-2">Last Name</label>
              <input type="text" id="editLastName" class="w-full px-4 py-3 bg-white/5 border border-gray-700 rounded-xl focus:border-primary focus:outline-none transition-colors">
            </div>
          </div>
         
          <div>
            <label class="block text-sm font-medium mb-2">Bio</label>
            <textarea id="editBio" class="w-full px-4 py-3 bg-white/5 border border-gray-700 rounded-xl focus:border-primary focus:outline-none transition-colors resize-none h-32"></textarea>
          </div>
         
          <div>
            <label class="block text-sm font-medium mb-2">Location</label>
            <select id="editLocation" class="w-full px-4 py-3 bg-white/5 border border-gray-700 rounded-xl focus:border-primary focus:outline-none transition-colors">
              <option value="mahama">Mahama Refugee Camp</option>
              <option value="community">Nearby Community</option>
              <option value="other">Other</option>
            </select>
          </div>
         
          <div class="flex gap-4 pt-4">
            <button type="submit" class="px-6 py-3 bg-primary text-white rounded-xl font-semibold hover:bg-primary-dark transition-colors flex-1">
              Save Changes
            </button>
            <button type="button" id="cancelEdit" class="px-6 py-3 border border-gray-600 text-gray-300 rounded-xl font-semibold hover:bg-white/5 transition-colors">
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Success Toast -->
  <div id="successToast" class="fixed top-20 right-4 bg-green-500 text-white px-6 py-3 rounded-xl shadow-lg z-50 transform translate-x-full transition-transform duration-300">
    <div class="flex items-center gap-3">
      <i class="fas fa-check-circle"></i>
      <span>Profile updated successfully!</span>
    </div>
  </div>

  <!-- Footer (Same as your main page) -->
  <footer class="bg-black text-slate-200 py-12 px-6 font-inter border-t border-slate-800">
    <div class="max-w-7xl mx-auto">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-8">
       
        <div class="col-span-1 md:col-span-2">
          <div class="flex items-center gap-3 mb-4">
            <img src="./img/Girls Space (1) (1).png" onerror="this.src='https://via.placeholder.com/50'" alt="Logo" class="w-[50px] h-[50px] object-contain rounded-full border-2 border-[rgb(255,135,219)]">
            <p class="font-semibold text-[rgb(255,135,219)] text-base">Empowering Girls, Building Futures</p>
          </div>
          <p class="text-sm leading-relaxed text-slate-400 max-w-sm mb-6">
            A safe digital haven where girls in Mahama refugee camp can connect, learn, grow, and thrive.
          </p>
          <div class="flex gap-3">
            <a href="#" class="w-10 h-10 bg-slate-800 border border-slate-700 rounded-lg flex items-center justify-center text-slate-300 hover:bg-slate-700 hover:text-white hover:-translate-y-1 transition-all"><i class="fab fa-facebook-f"></i></a>
            <a href="#" class="w-10 h-10 bg-slate-800 border border-slate-700 rounded-lg flex items-center justify-center text-slate-300 hover:bg-slate-700 hover:text-white hover:-translate-y-1 transition-all"><i class="fab fa-twitter"></i></a>
            <a href="#" class="w-10 h-10 bg-slate-800 border border-slate-700 rounded-lg flex items-center justify-center text-slate-300 hover:bg-slate-700 hover:text-white hover:-translate-y-1 transition-all"><i class="fab fa-instagram"></i></a>
            <a href="#" class="w-10 h-10 bg-slate-800 border border-slate-700 rounded-lg flex items-center justify-center text-slate-300 hover:bg-slate-700 hover:text-white hover:-translate-y-1 transition-all"><i class="fab fa-youtube"></i></a>
          </div>
        </div>

        <div>
          <h4 class="text-white font-semibold text-lg mb-4">Quick Links</h4>
          <ul class="space-y-3 text-sm text-slate-400">
            <li><a href="./chat.html" class="hover:text-[rgb(219,120,228)] transition-colors">Join Chat</a></li>
            <li><a href="./stories.html" class="hover:text-[rgb(219,120,228)] transition-colors">Share Story</a></li>
            <li><a href="./Learning_Programs.html" class="hover:text-[rgb(219,120,228)] transition-colors">Programs</a></li>
            <li><a href="./profile.html" class="hover:text-[rgb(219,120,228)] transition-colors text-[rgb(219,120,228)] font-medium">My Profile</a></li>
          </ul>
        </div>

        <div>
          <h4 class="text-white font-semibold text-lg mb-4">Get Help</h4>
          <ul class="space-y-3 text-sm text-slate-400">
            <li><a href="#" class="hover:text-[rgb(219,120,228)] transition-colors">Emergency</a></li>
            <li><a href="#" class="hover:text-[rgb(219,120,228)] transition-colors">Support</a></li>
            <li><a href="#" class="hover:text-[rgb(219,120,228)] transition-colors">Report</a></li>
          </ul>
        </div>
      </div>

      <div class="flex flex-col md:flex-row justify-between items-start md:items-end gap-4 pt-6 border-t border-slate-800 text-sm text-slate-500">
        <div>
          <p>© 2025 GirlsSpace Mahama. <span class="text-[rgb(183,64,219)] font-medium">Empowering girls, always.</span></p>
        </div>
        <div class="text-left md:text-right">
          <p class="mb-1">Available in: English, Français, Kiswahili, Kinyarwanda, Arabic</p>
          <p>Supported by UNHCR, Save The Children, Alight</p>
        </div>
      </div>
    </div>
  </footer>

  <script>
    // Tab Switching
    document.addEventListener('DOMContentLoaded', function() {
      const tabButtons = document.querySelectorAll('.tab-button');
      const tabContents = document.querySelectorAll('.tab-content');
     
      tabButtons.forEach(button => {
        button.addEventListener('click', function() {
          const tabId = this.getAttribute('data-tab');
         
          // Update active button
          tabButtons.forEach(btn => btn.classList.remove('active'));
          this.classList.add('active');
         
          // Show active tab content
          tabContents.forEach(content => {
            content.classList.add('hidden');
            if (content.id === `${tabId}-tab`) {
              content.classList.remove('hidden');
            }
          });
        });
      });
     
      // Mobile Menu Toggle
      const hamburger = document.getElementById('hamburger');
      const mobileMenu = document.getElementById('mobile-menu');
      const overlay = document.getElementById('mobile-menu-overlay');
     
      function toggleMenu() {
        hamburger.classList.toggle('active');
        const isOpen = hamburger.classList.contains('active');
        if (isOpen) {
          mobileMenu.style.left = '0';
          overlay.classList.remove('hidden');
        } else {
          mobileMenu.style.left = '-100%';
          overlay.classList.add('hidden');
        }
      }
     
      if (hamburger) hamburger.addEventListener('click', toggleMenu);
      if (overlay) overlay.addEventListener('click', toggleMenu);
     
      // Edit Profile Modal
      const editProfileBtn = document.getElementById('editProfileBtn');
      const editProfileModal = document.getElementById('editProfileModal');
      const closeEditModal = document.getElementById('closeEditModal');
      const cancelEdit = document.getElementById('cancelEdit');
      const editProfileForm = document.getElementById('editProfileForm');
      const successToast = document.getElementById('successToast');
      const deleteAccountBtn = document.getElementById('deleteAccountBtn');
     
      // Edit Picture Button
      const editPictureBtn = document.getElementById('editPictureBtn');
      const imageUpload = document.getElementById('imageUpload');
      const profileImage = document.getElementById('profileImage');
      const modalProfileImage = document.getElementById('modalProfileImage');
     
      if (editPictureBtn) {
        editPictureBtn.addEventListener('click', function() {
          imageUpload.click();
        });
      }
     
      if (imageUpload) {
        imageUpload.addEventListener('change', function(e) {
          const file = e.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = function(event) {
              profileImage.src = event.target.result;
              modalProfileImage.src = event.target.result;
            };
            reader.readAsDataURL(file);
          }
        });
      }
     
      if (editProfileBtn) {
        editProfileBtn.addEventListener('click', function() {
          // Populate modal with current data
          const userName = document.getElementById('userName').textContent;
          const userBio = document.getElementById('userBio').textContent;
         
          const nameParts = userName.split(' ');
          document.getElementById('editFirstName').value = nameParts[0] || '';
          document.getElementById('editLastName').value = nameParts.slice(1).join(' ') || '';
          document.getElementById('editBio').value = userBio;
         
          editProfileModal.classList.remove('hidden');
        });
      }
     
      if (closeEditModal) {
        closeEditModal.addEventListener('click', function() {
          editProfileModal.classList.add('hidden');
        });
      }
     
      if (cancelEdit) {
        cancelEdit.addEventListener('click', function() {
          editProfileModal.classList.add('hidden');
        });
      }
     
      if (editProfileForm) {
        editProfileForm.addEventListener('submit', function(e) {
          e.preventDefault();
         
          // Get form values
          const firstName = document.getElementById('editFirstName').value;
          const lastName = document.getElementById('editLastName').value;
          const bio = document.getElementById('editBio').value;
          const location = document.getElementById('editLocation').value;
         
          // Update profile display
          document.getElementById('userName').textContent = `\( {firstName} \){lastName}`;
          document.getElementById('userBio').textContent = bio;
         
          // Show success message
          successToast.style.transform = 'translateX(0)';
          setTimeout(() => {
            successToast.style.transform = 'translateX(100%)';
          }, 3000);
         
          // Close modal
          editProfileModal.classList.add('hidden');
         
          // In a real app, you would save to backend here
          console.log('Profile updated:', { firstName, lastName, bio, location });
        });
      }
     
      if (deleteAccountBtn) {
        deleteAccountBtn.addEventListener('click', function() {
          if (confirm('Are you sure you want to delete your account? This action cannot be undone.')) {
            // In a real app, this would call your backend API
            alert('Account deletion request sent. You will be logged out.');
            // Redirect to home or login page
            window.location.href = './index.html';
          }
        });
      }
     
      // Settings form submission
      const profileForm = document.getElementById('profileForm');
      if (profileForm) {
        profileForm.addEventListener('submit', function(e) {
          e.preventDefault();
         
          // Show success message
          successToast.style.transform = 'translateX(0)';
          setTimeout(() => {
            successToast.style.transform = 'translateX(100%)';
          }, 3000);
         
          console.log('Settings saved');
        });
      }
     
      // Load user data from localStorage or backend
      function loadUserData() {
        // In a real app, you would fetch from your backend
        // For now, we'll use localStorage or default data
       
        const userData = JSON.parse(localStorage.getItem('girlspaceUser')) || {
          firstName: 'Sarah',
          lastName: 'M.',
          bio: 'Passionate about education and women empowerment. I love sharing stories and learning new skills through GirlsSpace programs.',
          location: 'Mahama Refugee Camp',
          image: 'https://via.placeholder.com/160'
        };
       
        // Update UI
        document.getElementById('userName').textContent = `\( {userData.firstName} \){userData.lastName}`;
        document.getElementById('userBio').textContent = userData.bio;
        document.getElementById('profileImage').src = userData.image;
        document.getElementById('modalProfileImage').src = userData.image;
      }
     
      loadUserData();
     
      // Logout functionality
      const logoutBtn = document.getElementById('logoutBtn');
      const mobileLogoutBtn = document.getElementById('mobileLogoutBtn');
     
      function logout() {
        localStorage.removeItem('girlspaceUser');
        // In a real app, you would also clear authentication tokens
        window.location.href = './index.html';
      }
     
      if (logoutBtn) {
        logoutBtn.addEventListener('click', logout);
        logoutBtn.classList.remove('hidden');
      }
     
      if (mobileLogoutBtn) {
        mobileLogoutBtn.addEventListener('click', logout);
        mobileLogoutBtn.classList.remove('hidden');
      }
    });
  </script>
  <!-- Add this to your profile.html after your existing scripts -->
<script type="module">
  import { checkAuthState, setupLogout } from './firebaseauth.js';
 
  document.addEventListener('DOMContentLoaded', () => {
    // Check if user is logged in
    checkAuthState();
   
    // Setup logout functionality
    setupLogout();
   
    // Redirect to login if not authenticated
    const user = JSON.parse(localStorage.getItem('girlspaceUser'));
    if (!user) {
      window.location.href = './login.html';
    } else {
      // Load user data from localStorage
      document.getElementById('userName').textContent = user.displayName || 'User';
      document.getElementById('userBio').textContent = user.bio || 'Welcome to GirlsSpace!';
      if (user.photoURL) {
        document.getElementById('profileImage').src = user.photoURL;
        document.getElementById('modalProfileImage').src = user.photoURL;
      }
    }
  });
</script>
<!-- Add this to profile.html, before </body> -->
<script type="module">
  import { getCurrentUserProfile, updateUserProfile } from './user-profile-service.js';
 
  document.addEventListener('DOMContentLoaded', async () => {
    console.log('🚀 Loading user profile...');
   
    try {
      // Get user profile from Firebase
      const userProfile = await getCurrentUserProfile();
     
      if (!userProfile) {
        console.log('❌ No profile found, redirecting to login');
        window.location.href = './login.html';
        return;
      }
     
      console.log('✅ Profile loaded:', userProfile);
     
      // Update the UI with profile data
      updateProfileUI(userProfile);
     
      // Setup form submission for profile updates
      setupProfileUpdateForm(userProfile);
     
      // Load additional user data
      loadUserStatistics(userProfile.uid);
      loadUserStories(userProfile.uid);
      loadUserProgress(userProfile.uid);
     
    } catch (error) {
      console.error('❌ Error loading profile:', error);
      showError('Failed to load profile. Please try again.');
    }
  });
 
  // Function to update UI with profile data
  function updateProfileUI(profile) {
    // Update basic info
    document.getElementById('userName').textContent = profile.fullName || profile.email;
    document.getElementById('userBio').textContent = profile.bio || 'Welcome to GirlsSpace!';
   
    // Update profile picture
    const profileImage = document.getElementById('profileImage');
    const modalProfileImage = document.getElementById('modalProfileImage');
   
    if (profile.photoURL) {
      profileImage.src = profile.photoURL;
      if (modalProfileImage) modalProfileImage.src = profile.photoURL;
    }
   
    // Update location
    const locationElement = document.querySelector('[data-location]');
    if (locationElement) {
      locationElement.textContent = profile.location || 'Mahama Refugee Camp';
    }
   
    // Update member since date
    const memberSinceElement = document.querySelector('[data-member-since]');
    if (memberSinceElement && profile.createdAt) {
      const date = new Date(profile.createdAt);
      memberSinceElement.textContent = `Member since ${date.getFullYear()}`;
    }
   
    // Update settings form
    updateSettingsForm(profile);
  }
 
  // Function to update settings form
  function updateSettingsForm(profile) {
    const form = document.getElementById('profileForm');
    if (!form) return;
   
    // Pre-fill form fields
    const firstNameInput = form.querySelector('[name="firstName"]');
    const lastNameInput = form.querySelector('[name="lastName"]');
    const emailInput = form.querySelector('[name="email"]');
    const bioTextarea = form.querySelector('[name="bio"]');
    const locationSelect = form.querySelector('[name="location"]');
    const languageSelect = form.querySelector('[name="preferredLanguage"]');
   
    if (firstNameInput) firstNameInput.value = profile.firstName || '';
    if (lastNameInput) lastNameInput.value = profile.lastName || '';
    if (emailInput) emailInput.value = profile.email || '';
    if (bioTextarea) bioTextarea.value = profile.bio || '';
    if (locationSelect) locationSelect.value = profile.location || 'mahama';
    if (languageSelect) languageSelect.value = profile.preferredLanguage || 'en';
   
    // Handle form submission
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
     
      try {
        const updatedData = {
          firstName: firstNameInput.value,
          lastName: lastNameInput.value,
          fullName: `\( {firstNameInput.value} \){lastNameInput.value}`.trim(),
          bio: bioTextarea.value,
          location: locationSelect.value,
          preferredLanguage: languageSelect.value,
          updatedAt: new Date().toISOString()
        };
       
        console.log('📝 Updating profile with:', updatedData);
       
        const updatedProfile = await updateUserProfile(updatedData);
       
        // Update UI
        updateProfileUI(updatedProfile);
       
        showSuccessMessage('Profile updated successfully!');
       
      } catch (error) {
        console.error('Error updating profile:', error);
        showError('Failed to update profile. Please try again.');
      }
    });
  }
 
  // Function to load user statistics
  async function loadUserStatistics(userId) {
    try {
      // This would call your Firebase function to get statistics
      // For now, we'll use placeholder data
      const stats = {
        storiesCount: 24,
        chatMessagesCount: 156,
        programsCompleted: 8,
        badgesEarned: 5
      };
     
      // Update UI with statistics
      document.querySelector('.bg-white\\/5:nth-child(1) .text-2xl').textContent = stats.storiesCount;
      document.querySelector('.bg-white\\/5:nth-child(2) .text-2xl').textContent = stats.chatMessagesCount;
      document.querySelector('.bg-white\\/5:nth-child(3) .text-2xl').textContent = stats.programsCompleted;
      document.querySelector('.bg-white\\/5:nth-child(4) .text-2xl').textContent = stats.badgesEarned;
     
    } catch (error) {
      console.error('Error loading statistics:', error);
    }
  }
 
  // Function to load user stories
  async function loadUserStories(userId) {
    try {
      // You would query your stories collection here
      // const stories = await getUserStories(userId);
     
      // For now, we'll use placeholder
      console.log('Loading stories for user:', userId);
     
    } catch (error) {
      console.error('Error loading stories:', error);
    }
  }
 
  // Function to load user progress
  async function loadUserProgress(userId) {
    try {
      // You would query your userProgress collection here
      // const progress = await getUserProgress(userId);
     
      // For now, we'll use placeholder data
      const progress = {
        englishLanguage: 75,
        lifeSkills: 90,
        gbvPrevention: 60,
        digitalSkills: 45
      };
     
      // Update progress bars
      updateProgressBars(progress);
     
    } catch (error) {
      console.error('Error loading progress:', error);
    }
  }
 
  // Function to update progress bars
  function updateProgressBars(progress) {
    Object.keys(progress).forEach(key => {
      const progressBar = document.querySelector(`[data-progress="${key}"]`);
      if (progressBar) {
        progressBar.style.width = `${progress[key]}%`;
        progressBar.nextElementSibling.textContent = `${progress[key]}%`;
      }
    });
  }
 
  // Utility functions
  function showSuccessMessage(message) {
    const toast = document.getElementById('successToast');
    if (toast) {
      toast.querySelector('span').textContent = message;
      toast.style.transform = 'translateX(0)';
      setTimeout(() => {
        toast.style.transform = 'translateX(100%)';
      }, 3000);
    }
  }
 
  function showError(message) {
    alert(message); // You can replace this with a better error display
  }
</script>
<!-- ربط عدد القصص في الداشبورد مع Firebase -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-app.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-auth.js";
  import { getFirestore, collection, query, where, onSnapshot } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyD5K27SYd3NzV5FOtMtPZs_l8UhEUq42zc",
    authDomain: "sigin-b3aa1.firebaseapp.com",
    projectId: "sigin-b3aa1",
    storageBucket: "sigin-b3aa1.firebasestorage.app",
    messagingSenderId: "390069352394",
    appId: "1:390069352394:web:aa32d4a640b6f7fee54133"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  // العنصر اللي فيه عدد القصص في الداشبورد
  const storiesCountElement = document.querySelector('.bg-white\\/5 .text-2xl.text-primary');

  // لما يتغير حالة اللوجن
  onAuthStateChanged(auth, (user) => {
    if (user) {
      // جلب عدد القصص الخاصة بالمستخدمة في الوقت الفعلي
      const q = query(
        collection(db, "stories"),
        where("authorId", "==", user.uid)
        // لو عايزة تشملي القصص المعلقة (pending) كمان:
        // where("authorId", "==", user.uid)
      );

      // Real-time listener → كل ما تتضاف أو تتمسح قصة → يتحدث الرقم فورًا
      const unsubscribe = onSnapshot(q, (snapshot) => {
        const count = snapshot.size; // عدد الوثائق = عدد القصص

        if (storiesCountElement) {
          storiesCountElement.textContent = count;
         
          // اختياري: لو مفيش قصص → نكتب "0"
          if (count === 0) {
            storiesCountElement.textContent = "0";
          }
        }

        console.log(`عدد قصص المستخدمة: ${count}`);
      });

      // تنظيف الـ listener لما يطلع من الصفحة (مهم جدًا)
      window.addEventListener('beforeunload', () => unsubscribe());

    } else {
      // لو مش مسجلة دخول → 0 قصة
      if (storiesCountElement) {
        storiesCountElement.textContent = "0";
      }
    }
  });
</script>
<!-- 2. إظهار آخر قصة في Recent Activity -->
<script type="module">
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-auth.js";
  import { getFirestore, collection, query, where, onSnapshot, orderBy, limit } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-firestore.js";

  const auth = getAuth();
  const db = getFirestore();
  const recentList = document.querySelector('#overview-tab .space-y-4');

  function getTimeAgo(date) {
    const diff = Date.now() - date.getTime();
    const m = Math.floor(diff / 60000);
    const h = Math.floor(m / 60);
    if (m < 60) return `${m}m ago`;
    if (h < 24) return `${h}h ago`;
    return `${Math.floor(h/24)}d ago`;
  }

  onAuthStateChanged(auth, (user) => {
    if (!user || !recentList) return;

    const q = query(
      collection(db, "stories"),
      where("authorId", "==", user.uid),
      orderBy("createdAt", "desc"),
      limit(1)
    );

    onSnapshot(q, (snapshot) => {
      snapshot.docChanges().forEach(change => {
        if (change.type === "added") {
          const s = change.doc.data();
          const item = document.createElement('div');
          item.className = 'flex items-center gap-4 p-4 bg-white/5 rounded-xl';
          item.innerHTML = `
            <div class="w-12 h-12 rounded-full bg-primary/20 flex items-center justify-center">
              <i class="fas fa-pen text-primary"></i>
            </div>
            <div class="flex-1">
              <p class="font-medium">Posted a new story</p>
              <p class="text-sm text-gray-400">"${s.title}"</p>
            </div>
            <span class="text-sm text-gray-400">${getTimeAgo(s.createdAt.toDate())}</span>
          `;
          recentList.insertBefore(item, recentList.firstChild);
        }
      });
    });
  });
</script>
<!-- حذف القصص من الداشبورد + عرض القصص الخاصة بالمستخدمة -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-app.js";
  import {
    getAuth,
    onAuthStateChanged
  } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-auth.js";
  import {
    getFirestore,
    collection,
    query,
    where,
    onSnapshot,
    doc,
    deleteDoc
  } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyD5K27SYd3NzV5FOtMtPZs_l8UhEUq42zc",
    authDomain: "sigin-b3aa1.firebaseapp.com",
    projectId: "sigin-b3aa1",
    storageBucket: "sigin-b3aa1.firebasestorage.app",
    messagingSenderId: "390069352394",
    appId: "1:390069352394:web:aa32d4a640b6f7fee54133"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  // العناصر في الداشبورد
  const storiesCountElement = document.querySelector('.bg-white\\/5 .text-2xl.text-primary');
  const myStoriesContainer = document.getElementById('my-stories-container') ||
    document.querySelector('#stories-tab .grid') ||
    document.querySelector('#overview-tab .story-card')?.parentElement;

  // إنشاء قسم "My Stories" في تبويب Overview لو مش موجود
  let container = document.getElementById('my-stories-list');
  if (!container) {
    // نضيفه تحت Recent Activity أو في تبويب Stories
    const overviewTab = document.getElementById('overview-tab');
    if (overviewTab) {
      const existingSection = overviewTab.querySelector('.bg-gradient-to-br');
      const newSection = document.createElement('div');
      newSection.className = 'bg-gradient-to-br from-gray-900 to-dark rounded-2xl p-6 border border-gray-800';
      newSection.innerHTML = `
        <h2 class="text-2xl font-bold mb-6 flex items-center">
          My Stories
          <span class="ml-auto text-primary text-lg font-normal" id="my-stories-count">0</span>
        </h2>
        <div id="my-stories-list" class="space-y-4"></div>
        <div id="no-my-stories" class="text-center py-8 text-gray-400 hidden">
          You haven't shared any stories yet.
          <a href="./stories.html" class="text-primary block mt-2">Write your first story →</a>
        </div>
      `;
      // نضيفه بعد Recent Activity
      const recentActivitySection.after(newSection);
    }
  }

  const recentActivitySection = document.querySelector('.bg-gradient-to-br.from-gray-900');

  onAuthStateChanged(auth, (user) => {
    if (!user) {
      if (storiesCountElement) storiesCountElement.textContent = "0";
      return;
    }

    const userId = user.uid;

    // 1. تحديث عدد القصص
    const storiesQuery = query(
      collection(db, "stories"),
      where("authorId", "==", userId)
    );

    const unsubscribeCount = onSnapshot(storiesQuery, (snapshot) => {
      const count = snapshot.size;
      if (storiesCountElement) {
        storiesCountElement.textContent = count;
      }
      document.getElementById('my-stories-count')?.textContent = count;
    });

    // 2. عرض قصص المستخدمة مع زر حذف
    const unsubscribeStories = onSnapshot(storiesQuery, (snapshot) => {
      const list = document.getElementById('my-stories-list');
      const noStoriesMsg = document.getElementById('no-my-stories');

      if (!list) return;

      list.innerHTML = '';

      if (snapshot.empty) {
        noStoriesMsg?.classList.remove('hidden');
        return;
      }

      noStoriesMsg?.classList.add('hidden');

      snapshot.forEach((docSnap) => {
        const story = docSnap.data();
        const storyId = docSnap.id;

        const storyCard = document.createElement('div');
        storyCard.className = 'bg-white/5 rounded-xl p-4 flex justify-between items-start hover:bg-white/10 transition-all';

        const statusBadge = story.status === 'pending'
          ? '<span class="text-xs bg-yellow-500/20 text-yellow-300 px-2 py-1 rounded">Pending</span>'
          : '<span class="text-xs bg-green-500/20 text-green-300 px-2 py-1 rounded">Published</span>';

        storyCard.innerHTML = `
          <div class="flex-1">
            <h4 class="font-semibold text-lg">${escapeHtml(story.title || 'Untitled')}</h4>
            <p class="text-sm text-gray-400 mt-1">
              \( {new Date(story.createdAt?.toDate()).toLocaleDateString()} • \){story.category || 'General'}
            </p>
            <p class="text-gray-300 mt-2 line-clamp-2">
              ${escapeHtml(story.story_content?.substring(0, 100) || '')}...
            </p>
            <div class="mt-3">${statusBadge}</div>
          </div>
          <button onclick="deleteUserStory('${storyId}', this)"
                  class="ml-4 px-4 py-2 bg-red-600/20 text-red-400 rounded-lg hover:bg-red-600/40 transition-colors text-sm font-medium">
            Delete
          </button>
        `;

        list.appendChild(storyCard);
      });
    });

    // دالة الحذف (متاحة عالميًا)
    window.deleteUserStory = async (storyId, buttonElement) => {
      if (!confirm("Are you sure you want to delete this story? This action cannot be undone.")) {
        return;
      }

      try {
        buttonElement.disabled = true;
        buttonElement.textContent = "Deleting...";

        await deleteDoc(doc(db, "stories", storyId));

        // الـ UI هيتحدث تلقائيًا بسبب onSnapshot
        showSuccessToast("Story deleted successfully");

      } catch (error) {
        console.error("Error deleting story:", error);
        alert("Failed to delete story. Please try again.");
        buttonElement.disabled = false;
        buttonElement.textContent = "Delete";
      }
    };

    function showSuccessToast(msg) {
      const toast = document.createElement('div');
      toast.className = 'fixed top-20 right-4 bg-green-600 text-white px-6 py-3 rounded-xl shadow-lg z-50 transform translate-x-full transition-transform';
      toast.textContent = msg;
      document.body.appendChild(toast);

      setTimeout(() => toast.classList.remove('translate-x-full'), 100);
      setTimeout(() => {
        toast.classList.add('translate-x-full');
        setTimeout(() => document.body.removeChild(toast), 400);
      }, 3000);
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }
  });
</script>

<!-- ربط الاسم + الصورة + البيو + المكان مع Firebase (تحديث + عرض) -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-app.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-auth.js";
  import {
    getFirestore, doc, setDoc, getDoc, onSnapshot, serverTimestamp
  } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-firestore.js";
  import {
    getStorage, ref, uploadBytes, getDownloadURL
  } from "https://www.gstatic.com/firebasejs/10.11.1/firebase-storage.js";

  const firebaseConfig = {
    apiKey: "AIzaSyD5K27SYd3NzV5FOtMtPZs_l8UhEUq42zc",
    authDomain: "sigin-b3aa1.firebaseapp.com",
    projectId: "sigin-b3aa1",
    storageBucket: "sigin-b3aa1.firebasestorage.app",
    messagingSenderId: "390069352394",
    appId: "1:390069352394:web:aa32d4a640b6f7fee54133"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);
  const storage = getStorage(app);

  const userNameEl = document.getElementById('userName');
  const userBioEl = document.getElementById('userBio');
  const profileImageEl = document.getElementById('profileImage');
  const modalImageEl = document.getElementById('modalProfileImage');

  // تحميل بيانات المستخدم من Firebase
  onAuthStateChanged(auth, async (user) => {
    if (!user) {
      {
      window.location.href = "./login.html";
      return;
    }

    const userRef = doc(db, "users", user.uid);

    // نجيب البيانات في الوقت الفعلي
    onSnapshot(userRef, (docSnap) => {
      if (docSnap.exists()) {
        const data = docSnap.data();
        userNameEl.textContent = data.displayName || user.email.split('@')[0];
        userBioEl.textContent = data.bio || "Welcome to GirlsSpace!";
        if (data.photoURL) {
          profileImageEl.src = data.photoURL;
          modalImageEl.src = data.photoURL;
        }
      } else {
        // لو أول مرة → نعمل بروفايل افتراضي
        setDoc(userRef, {
          displayName: user.displayName || user.email.split('@')[0],
          photoURL: user.photoURL || "https://via.placeholder.com/160",
          bio: "مرحبًا! أنا عضوة جديدة في GirlsSpace",
          location: "Mahama Refugee Camp",
          createdAt: serverTimestamp()
        });
      }
    });
  });

  // تعديل الصورة
  document.getElementById('editPictureBtn')?.addEventListener('click', () => {
    document.getElementById('imageUpload').click();
  });

  document.getElementById('imageUpload')?.addEventListener('change', async (e) => {
    const file = e.target.files[0];
    if (!file || !auth.currentUser) return;

    const user = auth.currentUser;
    const storageRef = ref(storage, `profilePictures/${user.uid}`);

    try {
      // رفع الصورة
      await uploadBytes(storageRef, file);
      const photoURL = await getDownloadURL(storageRef);

      // حفظ الرابط في Firestore
      await setDoc(doc(db, "users", user.uid), {
        photoURL: photoURL,
        updatedAt: serverTimestamp()
      }, { merge: true });

      // تحديث الصورة فورًا
      profileImageEl.src = photoURL;
      modalImageEl.src = photoURL;

      showToast("تم تحديث الصورة بنجاح!");
    } catch (error) {
      showToast("فشل رفع الصورة", "error");
    }
  });

  // تعديل الاسم والبيو من المودال
  document.getElementById('editProfileForm')?.addEventListener('submit', async (e) => {
    e.preventDefault();
    const user = auth.currentUser;
    if (!user) return;

    const firstName = document.getElementById('editFirstName').value.trim();
    const lastName = document.getElementById('editLastName').value.trim();
    const bio = document.getElementById('editBio').value.trim();

    if (!firstName) return alert("الاسم مطلوب");

    try {
      await setDoc(doc(db, "users", user.uid), {
        displayName: `\( {firstName} \){lastName}`.trim(),
        bio: bio || "لا يوجد وصف",
        updatedAt: serverTimestamp()
      }, { merge: true });

      // تحديث الواجهة فورًا
      userNameEl.textContent = `\( {firstName} \){lastName}`;
      userBioEl.textContent = bio || "لا يوجد وصف";

      document.getElementById('editProfileModal').classList.add('hidden');
      showToast("تم حفظ التغييرات بنجاح!");
    } catch (error) {
      showToast("خطأ في الحفظ", "error");
    }
  });

  // فتح المودال وملء الحقول
  document.getElementById('editProfileBtn')?.addEventListener('click', async () => {
    const user = auth.currentUser;
    if (!user) return;

    const docSnap = await getDoc(doc(db, "users", user.uid));
    if (docSnap.exists()) {
      const data = docSnap.data();
      const nameParts = (data.displayName || "").split(" ");
      document.getElementById('editFirstName').value = nameParts[0] || "";
      document.getElementById('editLastName').value = nameParts.slice(1).join(" ") || "";
      document.getElementById('editBio').value = data.bio || "";
    }
    document.getElementById('editProfileModal').classList.remove('hidden');
  });

  function showToast(msg, type = 'success') {
    const t = document.createElement('div');
    t.textContent = msg;
    t.className = `fixed top-20 right-4 z-50 px-6 py-3 rounded-xl text-white font-bold shadow-lg ${type==='success'?'bg-green-600':'bg-red-600'}`;
    document.body.appendChild(t);
    setTimeout(() => t.remove(), 3000);
  }
</script>
</body>
</html>